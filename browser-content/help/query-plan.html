<style type="text/css" media="screen">
  .imageblock .content img {
    max-width: 900px;
    max-height: 300px;
  }

  article.asciidoc .deck h3 {
    display: block !important;
    margin-bottom: 8px;
    margin-top: 5px;
  }

  .listingblock {
    margin: 8px;
  }

  article.asciidoc .pull-bottom {
    position: relative;
    bottom: 1em;
  }

  /* Runnable content */

  article.asciidoc p > code.runnable:before {
    content: "\f144";
    color: #428bca;
    font-family: FontAwesome;
    padding-right: 4px;
  }

  /* Labeled lists */

  .hdlist > .title {
    line-height: 1.45;
    color: #7a2518;
    font-weight: 400;
    margin-top: 0;
    margin-bottom: .25em;
  }

  .hdlist > table, .colist > table {
    border: 0;
    background: none;
  }

  .hdlist > table > tbody > tr, .colist > table > tbody > tr {
    background: none;
  }

  td.hdlist1, td.hdlist2 {
    vertical-align: top;
    padding: 0 .625em;
  }

  td.hdlist1 {
    font-weight: bold;
    padding-bottom: 1.25em;
  }

  article.asciidoc div.hdlist table tr.even, article.asciidoc div.hdlist table tr.alt, article.asciidoc div.hdlist
  table tr:nth-of-type(even) {
    background: none;
  }

  /* Lists */

  article.asciidoc div.ulist > ul div.ulist > ul {
    list-style-type: circle;
  }

  /* Admonition Blocks */
  .admonitionblock td.icon [class^="fa icon-"] {
    font-size: 2.5em;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
    cursor: default;
  }

  .admonitionblock td.icon .icon-note:before {
    content: "\f05a";
    color: #19407c;
  }

  .admonitionblock td.icon .icon-tip:before {
    content: "\f0eb";
    text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
    color: #111;
  }

  .admonitionblock td.icon .icon-warning:before {
    content: "\f071";
    color: #bf6900;
  }

  .admonitionblock td.icon .icon-caution:before {
    content: "\f06d";
    color: #bf3400;
  }

  .admonitionblock td.icon .icon-important:before {
    content: "\f06a";
    color: #bf0000;
  }

  .admonitionblock > table {
    border-collapse: separate;
    border: 0;
    background: none;
    width: 100%;
  }

  .admonitionblock > table td.icon {
    text-align: center;
    width: 80px;
  }

  .admonitionblock > table td.icon img {
    max-width: none;
  }

  .admonitionblock > table td.icon .title {
    font-weight: bold;
    text-transform: uppercase;
  }

  .admonitionblock > table td.content {
    padding-left: 1.125em;
    padding-right: 1.25em;
    border-left: 1px solid #ddddd8;
    font-size: 1.1539em;
    color: rgba(0, 0, 0, .6);
  }

  .admonitionblock > table td.content > :last-child > :last-child {
    margin-bottom: 0;
  }

  /* kbd */
  article.asciidoc kbd {
    display: inline-block;
    color: rgba(0, 0, 0, 1);
    font-size: .75em;
    line-height: 1.4;
    background-color: #f7f7f7;
    border: 1px solid #ccc;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
    box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
    margin: -.15em .15em 0 .15em;
    padding: .2em .6em .2em .5em;
    vertical-align: middle;
    white-space: nowrap;
  }

  article.asciidoc .keyseq kbd:first-child {
    margin-left: 0;
  }

  article.asciidoc .keyseq kbd:last-child {
    margin-right: 0;
  }

  /* Tables */
  article.asciidoc table thead {
    background: #f7f8f7;
  }

  article.asciidoc table thead tr th, article.asciidoc table thead tr td {
    padding: .5em .625em .625em;
    color: rgba(0, 0, 0, .8);
    text-align: left
  }

  article.asciidoc table tr th, article.asciidoc table tr td {
    padding: .5625em .625em;
    font-size: inherit;
    color: rgba(0, 0, 0, .8)
  }

  article.asciidoc table tr.even, article.asciidoc table tr.alt, article.asciidoc table tr:nth-of-type(even) {
    background: #f8f8f7
  }

  article.asciidoc table thead tr th, article.asciidoc table tbody tr td, article.asciidoc table tr td {
    display: table-cell;
    line-height: 1.6
  }

  table.tableblock {
    max-width: 100%;
    border-collapse: separate
  }

  table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child {
    margin-bottom: 0
  }

  table.spread {
    width: 100%
  }

  table.tableblock, th.tableblock, td.tableblock {
    border: 0 solid #dedede
  }

  th.halign-left, td.halign-left {
    text-align: left
  }

  th.halign-right, td.halign-right {
    text-align: right
  }

  th.halign-center, td.halign-center {
    text-align: center
  }

  th.valign-top, td.valign-top {
    vertical-align: top
  }

  th.valign-bottom, td.valign-bottom {
    vertical-align: bottom
  }

  th.valign-middle, td.valign-middle {
    vertical-align: middle
  }

  article.asciidoc table thead th {
    font-size: 1.2em;
  }

  article.asciidoc tbody tr th {
    background: #f7f8f7;
  }

  p.tableblock > code:only-child {
    background: none;
    padding: 0
  }
</style>
<article class="guide asciidoc">
  <carousel class="deck container-fluid">
    
    

    <slide class="row-fluid">
      <div class="col-sm-12">
        <h3>Query Plan</h3>
        <br/>
        <div>
          <div class="paragraph">
<p>Understand what cypher is doing</p>
</div>
<div class="paragraph">
<p>Cypher breaks down the work of executing a query into small pieces
called <em>operators</em>. Each operator is responsible for a small part of
the overall query. The operators are connected together in a pattern
called a Query Plan.</p>
</div>
<div class="paragraph">
<p>When you use the EXPLAIN or PROFILE commands, Neo4j Browser displays a
diagram of the Query Plan.</p>
</div>
<div class="paragraph">
<p>Click the right arrow button for the later pages of this guide, which
explain how to read the Query Plan diagram.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/images/query-plan.svg" alt="image"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/images/query-plan-operator-rows.svg" alt="image"></span></p>
</div>


    <div class="paragraph">
<p>Each Operator is displayed as a rectangle with its name in the top-left
corner. See
the http://neo4j.com/docs/%7B%7Bneo4j.version%7D%7D/execution-plans.html[operators
manual page] for a description of what each operator does.</p>
</div>



    <div class="paragraph">
<p>Operators are connected by pipes; each pipe represents the output of one
operator and the input of the next.</p>
</div>



    <div class="paragraph">
<p>In Query Plan diagrams, the width of a pipe indicates the number of rows
that pass between operators. This means that by looking at the overall
diagram, you can quickly see the <em>shape</em> of the query, in terms of
which parts process lots of rows, and which parts process few.</p>
</div>



    <div class="paragraph">
<p>When you use the EXPLAIN keyword, the query is not actually executed; so
it&#8217;s not possible to show actual number of rows for each pipe. In this
case, the Query Plan diagram shows <em>estimated rows</em> instead. These
numbers are predicted based on Neo4j&#8217;s built-in statistics. The Cypher
cost-based planner uses estimated rows to determine the optimal query
plan.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/images/query-plan-operator-cost.svg" alt="image"></span></p>
</div>



    <div class="paragraph">
<p>Each operator will ask the Neo4j storage engine to do work such as
retrieving or updating data. A <em>database hit</em> is an abstract unit of
this storage engine work.</p>
</div>
<div class="paragraph">
<p>When you use the PROFILEcommand, the footer of the result frame displays
the total number of database hits incurred while running the query. By
comparing this total for different query plans, you can tell which one
is better in terms of work for the storage engine.</p>
</div>
<div class="paragraph">
<p>In addition of the total number of database hits, the Query Plan diagram
shows the database hits for each individual operator. For operators with
a large number of database hits, there is a red box underneath the
operator, with its height proportional to the number. This means that
you can glance very quickly at the whole Query Plan diagram and spot the
operators that are responsible for significant storage engine work.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./images/images/query-plan-operator-details.svg" alt="image"></span></p>
</div>



    <div class="paragraph">
<p>Some operators can reveal more information about what they are doing. If
you see a triangular expand icon next to the operator name, you can
click to expand the operator and reveal some more details. When you&#8217;re
done, you can click the header again to collapse the operator and hide
the details.</p>
</div>
<div class="paragraph">
<p>If you want to quickly expand all the operators, there are
expand-all <em><em>_ and collapse-all </em>_</em> buttons below the diagram.</p>
</div>



    <div class="paragraph">
<p>The first section of details lists the identifiers that the operator
works with. if you&#8217;ve named identifers in your query, e.g. <code>MATCH (n)</code>
then you should find the identifier n bound in one of the operators. In
addition to identifiers that you named in your query you may see some
internal identifiers that Cypher has introduced to keep track of unnamed
entities.</p>
</div>



    <div class="paragraph">
<p>After the identifiers, you&#8217;ll see a section for an expression. This is
commonly a boolean expression such as <code>hasProp(born)</code> or it can be a
graph pattern to be expanded such as <code>()-[r]-()</code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Execution Plans</code> manual page</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Related:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">:help EXPLAIN :help PROFILE </p></td>
</tr>
</tbody>
</table>

        </div>
      </div>
    </slide>

  </carousel>
</article>