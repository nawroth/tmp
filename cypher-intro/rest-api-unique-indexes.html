<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>22.19. Unique Indexing -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="rest-api-indexes.html" title="22.18. Legacy indexing" /><link rel="next" href="rest-api-auto-indexes.html" title="22.20. Legacy Automatic Indexes" /><link rel="copyright" href="ln-d5e41.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="22.19. Unique Indexing" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-65659";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script><script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.0/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/codemirror.css" />
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/theme/neo.css" />
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/codemirror.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/addon/runmode/runmode.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/javascript/javascript.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/shell/shell.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/sql/sql.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/xml/xml.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/clike/clike.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/codemirror/4.3.0/mode/cypher/cypher.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="http://docs.neo4j.org/chunked/versions.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>22.19. Unique Indexing</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="rest-api-indexes.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="rest-api.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="rest-api-auto-indexes.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="rest-api-unique-indexes"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">22.19. Unique Indexing</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-create">Get or create unique node (create)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-node-existing">Get or create unique node (existing)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-create">Create a unique node or return fail (create)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-node-or-return-fail-fail">Create a unique node or return fail (fail)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-not-indexed">Add an existing node to unique index (not indexed)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-node-to-unique-index-already-indexed">Add an existing node to unique index (already indexed)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-create">Get or create unique relationship (create)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-get-or-create-unique-relationship-existing">Get or create unique relationship (existing)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-create">Create a unique relationship or return fail (create)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-create-a-unique-relationship-or-return-fail-fail">Create a unique relationship or return fail (fail)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-not-indexed">Add an existing relationship to a unique index (not indexed)</a></span></li><li><span class="section"><a href="rest-api-unique-indexes.html#rest-api-add-an-existing-relationship-to-a-unique-index-already-indexed">Add an existing relationship to a unique index (already indexed)</a></span></li></ul></div>

<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>As of Neo4j 2.0, unique constraints have been added.
These make Neo4j enforce the uniqueness, guaranteeing that uniqueness is maintained.
See <a class="xref" href="graphdb-neo4j-schema.html#graphdb-neo4j-schema-constraints" title="Constraints">the section called “Constraints”</a> for details about this.
For most cases, the unique constraints should be used rather than the features described below.</p></td></tr></table></div>
<p>For uniqueness enforcements, there are two modes:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

URL Parameter <code class="literal">uniqueness=get_or_create</code>: Create a new node/relationship and index it if no existing one can be found. If an existing node/relationship is found, discard the sent data and return the existing node/relationship.

</li><li class="listitem">

URL Parameter <code class="literal">uniqueness=create_or_fail</code>: Create a new node/relationship if no existing one can be found in the index. If an existing node/relationship is found, return a conflict error.

</li></ul></div>
<p>For more information, see <a class="xref" href="transactions-unique-nodes.html" title="19.6. Creating unique nodes">Section 19.6, “Creating unique nodes”</a>.</p>
<section class="section" id="rest-api-get-or-create-unique-node-create"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Get or create unique node (create)</h3></div></div></div>

<p>The node is created if it doesn’t exist in the unique index already.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=get_or_create</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Tobias",
  "properties" : {
    "name" : "Tobias",
    "sequence" : 1
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Tobias/22</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/22/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/22/labels",
  "traverse" : "http://localhost:7474/db/data/node/22/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/22/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/22",
  "property" : "http://localhost:7474/db/data/node/22/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/22/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/22/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/22/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/22/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/22/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/22/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/22/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 22,
    "labels" : [ ]
  },
  "data" : {
    "sequence" : 1,
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Tobias/22"
}</pre>
</section>
<section class="section" id="rest-api-get-or-create-unique-node-existing"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Get or create unique node (existing)</h3></div></div></div>

<p>Here,
a node is not created but the existing unique node returned, since another node
is indexed with the same data already. The node data returned is then that of the
already existing node.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=get_or_create</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "properties" : {
    "name" : "Peter",
    "sequence" : 2
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Peter/12</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/12/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/12/labels",
  "traverse" : "http://localhost:7474/db/data/node/12/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/12/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/12",
  "property" : "http://localhost:7474/db/data/node/12/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/12/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/12/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/12/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/12/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/12/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/12/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/12/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 12,
    "labels" : [ ]
  },
  "data" : {
    "sequence" : 1,
    "name" : "Peter"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Peter/12"
}</pre>
</section>
<section class="section" id="rest-api-create-a-unique-node-or-return-fail-create"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a unique node or return fail (create)</h3></div></div></div>

<p>Here, in case
of an already existing node, an error should be returned. In this
example, no existing indexed node is found and a new node is created.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Tobias",
  "properties" : {
    "name" : "Tobias",
    "sequence" : 1
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/people/name/Tobias/21</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/21/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/21/labels",
  "traverse" : "http://localhost:7474/db/data/node/21/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/21/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/21",
  "property" : "http://localhost:7474/db/data/node/21/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/21/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/21/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/21/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/21/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/21/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/21/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/21/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 21,
    "labels" : [ ]
  },
  "data" : {
    "sequence" : 1,
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Tobias/21"
}</pre>
</section>
<section class="section" id="rest-api-create-a-unique-node-or-return-fail-fail"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a unique node or return fail (fail)</h3></div></div></div>

<p>Here, in case
of an already existing node, an error should be returned. In this
example, an existing node indexed with the same data
is found and an error is returned.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/people?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "properties" : {
    "name" : "Peter",
    "sequence" : 2
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/6/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/6/labels",
  "traverse" : "http://localhost:7474/db/data/node/6/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/6/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/6",
  "property" : "http://localhost:7474/db/data/node/6/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/6/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/6/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/6/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/6/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/6/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/6/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/6/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 6,
    "labels" : [ ]
  },
  "data" : {
    "sequence" : 1,
    "name" : "Peter"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/people/name/Peter/6"
}</pre>
</section>
<section class="section" id="rest-api-add-an-existing-node-to-unique-index-not-indexed"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Add an existing node to unique index (not indexed)</h3></div></div></div>

<p>Associates a node with the given key/value pair in the given unique
index.</p>
<p>In this example, we are using <code class="literal">create_or_fail</code> uniqueness.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/favorites?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "value" : "some value",
  "uri" : "http://localhost:7474/db/data/node/17",
  "key" : "some-key"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/17</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/17/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/17/labels",
  "traverse" : "http://localhost:7474/db/data/node/17/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/17/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/17",
  "property" : "http://localhost:7474/db/data/node/17/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/17/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/17/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/17/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/17/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/17/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/17/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/17/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 17,
    "labels" : [ ]
  },
  "data" : { },
  "indexed" : "http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/17"
}</pre>
</section>
<section class="section" id="rest-api-add-an-existing-node-to-unique-index-already-indexed"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Add an existing node to unique index (already indexed)</h3></div></div></div>

<p>In this case, the node already exists in the index, and thus we get a <code class="literal">HTTP 409</code> status response,
as we have set the uniqueness to <code class="literal">create_or_fail</code>.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/favorites?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "value" : "some value",
  "uri" : "http://localhost:7474/db/data/node/20",
  "key" : "some-key"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "outgoing_relationships" : "http://localhost:7474/db/data/node/19/relationships/out",
  "labels" : "http://localhost:7474/db/data/node/19/labels",
  "traverse" : "http://localhost:7474/db/data/node/19/traverse/{returnType}",
  "all_typed_relationships" : "http://localhost:7474/db/data/node/19/relationships/all/{-list|&amp;|types}",
  "self" : "http://localhost:7474/db/data/node/19",
  "property" : "http://localhost:7474/db/data/node/19/properties/{key}",
  "properties" : "http://localhost:7474/db/data/node/19/properties",
  "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/19/relationships/out/{-list|&amp;|types}",
  "incoming_relationships" : "http://localhost:7474/db/data/node/19/relationships/in",
  "create_relationship" : "http://localhost:7474/db/data/node/19/relationships",
  "paged_traverse" : "http://localhost:7474/db/data/node/19/paged/traverse/{returnType}{?pageSize,leaseTime}",
  "all_relationships" : "http://localhost:7474/db/data/node/19/relationships/all",
  "incoming_typed_relationships" : "http://localhost:7474/db/data/node/19/relationships/in/{-list|&amp;|types}",
  "metadata" : {
    "id" : 19,
    "labels" : [ ]
  },
  "data" : {
    "some-key" : "some value"
  },
  "indexed" : "http://localhost:7474/db/data/index/node/favorites/some-key/some%20value/19"
}</pre>
</section>
<section class="section" id="rest-api-get-or-create-unique-relationship-create"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Get or create unique relationship (create)</h3></div></div></div>

<p>Create a unique relationship in an index.
If a relationship matching the given key and value already exists in the index, it will be returned.
If not, a new relationship will be created.</p>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>The type and direction of the relationship is not regarded when determining uniqueness.</p></td></tr></table></div>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/MyIndex/?uniqueness=get_or_create</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Tobias",
  "start" : "http://localhost:7474/db/data/node/16",
  "end" : "http://localhost:7474/db/data/node/17",
  "type" : "knowledge"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/MyIndex/name/Tobias/7</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/16",
  "property" : "http://localhost:7474/db/data/relationship/7/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/7",
  "properties" : "http://localhost:7474/db/data/relationship/7/properties",
  "type" : "knowledge",
  "end" : "http://localhost:7474/db/data/node/17",
  "metadata" : {
    "id" : 7,
    "type" : "knowledge"
  },
  "data" : {
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/MyIndex/name/Tobias/7"
}</pre>
</section>
<section class="section" id="rest-api-get-or-create-unique-relationship-existing"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Get or create unique relationship (existing)</h3></div></div></div>

<p>Here, in case
of an already existing relationship, the sent data is ignored and the
existing relationship returned.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=get_or_create</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "start" : "http://localhost:7474/db/data/node/20",
  "end" : "http://localhost:7474/db/data/node/21",
  "type" : "KNOWS"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/18",
  "property" : "http://localhost:7474/db/data/relationship/8/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/8",
  "properties" : "http://localhost:7474/db/data/relationship/8/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/19",
  "metadata" : {
    "id" : 8,
    "type" : "KNOWS"
  },
  "data" : { },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/8"
}</pre>
</section>
<section class="section" id="rest-api-create-a-unique-relationship-or-return-fail-create"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a unique relationship or return fail (create)</h3></div></div></div>

<p>Here, in case
of an already existing relationship, an error should be returned. In this
example, no existing relationship is found and a new relationship is created.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Tobias",
  "start" : "http://localhost:7474/db/data/node/28",
  "end" : "http://localhost:7474/db/data/node/29",
  "type" : "KNOWS"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/rels/name/Tobias/11</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/28",
  "property" : "http://localhost:7474/db/data/relationship/11/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/11",
  "properties" : "http://localhost:7474/db/data/relationship/11/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/29",
  "metadata" : {
    "id" : 11,
    "type" : "KNOWS"
  },
  "data" : {
    "name" : "Tobias"
  },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Tobias/11"
}</pre>
</section>
<section class="section" id="rest-api-create-a-unique-relationship-or-return-fail-fail"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a unique relationship or return fail (fail)</h3></div></div></div>

<p>Here, in case
of an already existing relationship, an error should be returned. In this
example, an existing relationship is found and an error is returned.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "start" : "http://localhost:7474/db/data/node/8",
  "end" : "http://localhost:7474/db/data/node/9",
  "type" : "KNOWS"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/6",
  "property" : "http://localhost:7474/db/data/relationship/3/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/3",
  "properties" : "http://localhost:7474/db/data/relationship/3/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/7",
  "metadata" : {
    "id" : 3,
    "type" : "KNOWS"
  },
  "data" : { },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/3"
}</pre>
</section>
<section class="section" id="rest-api-add-an-existing-relationship-to-a-unique-index-not-indexed"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Add an existing relationship to a unique index (not indexed)</h3></div></div></div>

<p>If a relationship matching the given key and value already exists in the index, it will be returned.
If not, an <code class="literal">HTTP 409</code> (conflict) status will be returned in this case, as we are using <code class="literal">create_or_fail</code>.</p>
<p>It’s possible to use <code class="literal">get_or_create</code> uniqueness as well.</p>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>The type and direction of the relationship is not regarded when determining uniqueness.</p></td></tr></table></div>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "uri" : "http://localhost:7474/db/data/relationship/2"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/rels/name/Peter/2</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/4",
  "property" : "http://localhost:7474/db/data/relationship/2/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/2",
  "properties" : "http://localhost:7474/db/data/relationship/2/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/5",
  "metadata" : {
    "id" : 2,
    "type" : "KNOWS"
  },
  "data" : { },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/2"
}</pre>
</section>
<section class="section" id="rest-api-add-an-existing-relationship-to-a-unique-index-already-indexed"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Add an existing relationship to a unique index (already indexed)</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/rels?uniqueness=create_or_fail</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "key" : "name",
  "value" : "Peter",
  "uri" : "http://localhost:7474/db/data/relationship/5"
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">409:</code></strong></span> <code class="literal">Conflict</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "extensions" : { },
  "start" : "http://localhost:7474/db/data/node/10",
  "property" : "http://localhost:7474/db/data/relationship/4/properties/{key}",
  "self" : "http://localhost:7474/db/data/relationship/4",
  "properties" : "http://localhost:7474/db/data/relationship/4/properties",
  "type" : "KNOWS",
  "end" : "http://localhost:7474/db/data/node/11",
  "metadata" : {
    "id" : 4,
    "type" : "KNOWS"
  },
  "data" : { },
  "indexed" : "http://localhost:7474/db/data/index/relationship/rels/name/Peter/4"
}</pre>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://www.neotechnology.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>