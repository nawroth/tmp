<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>25.7. REST endpoint for HA status information -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="ha-setup-tutorial.html" title="25.6. High Availability setup tutorial" /><link rel="next" href="ha-haproxy.html" title="25.8. Setting up HAProxy as a load balancer" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="25.7. REST endpoint for HA status information" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-68604";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<!-- Scrolling -->
<script type="text/javascript" src="common/jquery/jquery.kinetic.min.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>25.7. REST endpoint for HA status information</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="ha-setup-tutorial.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="ha.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="ha-haproxy.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="ha-rest-info"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">25.7. REST endpoint for HA status information</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="ha-rest-info.html#_introduction_8">Introduction</a></span></li><li><span class="section"><a href="ha-rest-info.html#_the_endpoints">The endpoints</a></span></li><li><span class="section"><a href="ha-rest-info.html#_examples">Examples</a></span></li></ul></div>

<section class="section" id="_introduction_8"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Introduction</h3></div></div></div>

<p>A common use case for Neo4j HA clusters is to direct all write requests to the master while using slaves for read operations, distributing the read load across the cluster and and gain failover capabilities for your deployment.
The most common way to achieve this is to place a load balancer in front of the HA cluster, an example being shown with <a class="link" href="ha-haproxy.html" title="25.8. Setting up HAProxy as a load balancer">HA Proxy</a>.
As you can see in that guide, it makes use of a REST endpoint to discover which instance is the master and direct write load to it.
In this section, we’ll deal with this REST endpoint and explain its semantics.</p>
</section>
<section class="section" id="_the_endpoints"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">The endpoints</h3></div></div></div>

<p>Each HA instance comes with 3 endpoints regarding its HA status.
They are complimentary but each may be used depending on your load balancing needs and your production setup.
Those are:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<code class="literal">/db/manage/server/ha/master</code>

</li><li class="listitem">

<code class="literal">/db/manage/server/ha/slave</code>

</li><li class="listitem">

<code class="literal">/db/manage/server/ha/available</code>

</li></ul></div>
<p>The <code class="literal">/master</code> and <code class="literal">/slave</code> endpoints can be used to direct write and non-write traffic respectively to specific
instances. This is the optimal way to take advantage of Neo4j’s scaling characteristics. The <code class="literal">/available</code> endpoint
exists for the general case of directing arbitrary request types to instances that are available for transaction
processing.</p>
<p>To use the endpoints, perform an HTTP GET operation on either and the following will be returned:</p>
<div class="table" id="d5e24070"><p class="title"><strong>HA REST endpoint responses</strong></p><div class="table-contents">

<table cellspacing="0" cellpadding="0"><thead><tr><th> Endpoint                              </th><th> Instance State  </th><th> Returned Code  </th><th> Body text</th></tr></thead><tbody><tr><td rowspan="3"><p><code class="literal">/db/manage/server/ha/master</code></p></td><td><p>Master</p></td><td><p><code class="literal">200 OK</code></p></td><td><p><code class="literal">true</code></p></td></tr><tr><td><p>Slave</p></td><td><p><code class="literal">404 Not Found</code></p></td><td><p><code class="literal">false</code></p></td></tr><tr><td><p>Unknown</p></td><td><p><code class="literal">404 Not Found</code></p></td><td><p><code class="literal">UNKNOWN</code></p></td></tr><tr><td rowspan="3"><p><code class="literal">/db/manage/server/ha/slave</code></p></td><td><p>Master</p></td><td><p><code class="literal">404 Not Found</code></p></td><td><p><code class="literal">false</code></p></td></tr><tr><td><p>Slave</p></td><td><p><code class="literal">200 OK</code></p></td><td><p><code class="literal">true</code></p></td></tr><tr><td><p>Unknown</p></td><td><p><code class="literal">404 Not Found</code></p></td><td><p><code class="literal">UNKNOWN</code></p></td></tr><tr><td rowspan="3"><p><code class="literal">/db/manage/server/ha/available</code></p></td><td><p>Master</p></td><td><p><code class="literal">200 OK</code></p></td><td><p><code class="literal">master</code></p></td></tr><tr><td><p>Slave</p></td><td><p><code class="literal">200 OK</code></p></td><td><p><code class="literal">slave</code></p></td></tr><tr><td><p>Unknown</p></td><td><p><code class="literal">404 Not Found</code></p></td><td><p><code class="literal">UNKNOWN</code></p></td></tr></tbody></table>
</div></div>
</section>
<section class="section" id="_examples"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Examples</h3></div></div></div>

<p>From the command line, a common way to ask those endpoints is to use <code class="literal">curl</code>.
With no arguments, <code class="literal">curl</code> will do an HTTP <code class="literal">GET</code> on the URI provided and will output the body text, if any.
If you also want to get the response code, just add the <code class="literal">-v</code> flag for verbose output. Here are some examples:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

Requesting <code class="literal">master</code> endpoint on a running master with verbose output

</li></ul></div>
<pre class="programlisting" data-lang="shell">#&gt; curl -v localhost:7474/db/manage/server/ha/master
* About to connect() to localhost port 7474 (#0)
*   Trying ::1...
* connected
* Connected to localhost (::1) port 7474 (#0)
&gt; GET /db/manage/server/ha/master HTTP/1.1
&gt; User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
&gt; Host: localhost:7474
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/plain
&lt; Access-Control-Allow-Origin: *
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(6.1.25)
&lt;
* Connection #0 to host localhost left intact
true* Closing connection #0</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

Requesting <code class="literal">slave</code> endpoint on a running master without verbose output:

</li></ul></div>
<pre class="programlisting" data-lang="shell">#&gt; curl localhost:7474/db/manage/server/ha/slave
false</pre>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

Finally, requesting the <code class="literal">master</code> endpoint on a slave with verbose output

</li></ul></div>
<pre class="programlisting" data-lang="shell">#&gt; curl -v localhost:7475/db/manage/server/ha/master
* About to connect() to localhost port 7475 (#0)
*   Trying ::1...
* connected
* Connected to localhost (::1) port 7475 (#0)
&gt; GET /db/manage/server/ha/master HTTP/1.1
&gt; User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
&gt; Host: localhost:7475
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 404 Not Found
&lt; Content-Type: text/plain
&lt; Access-Control-Allow-Origin: *
&lt; Transfer-Encoding: chunked
&lt; Server: Jetty(6.1.25)
&lt;
* Connection #0 to host localhost left intact
false* Closing connection #0</pre>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Unknown status</b>

<p>The <code class="literal">UNKNOWN</code> status exists to describe when a Neo4j instance is neither master nor slave.
For example, the instance could be transitioning between states (master to slave in a recovery scenario or slave being promoted to master in the event of failure).
If the <code class="literal">UNKNOWN</code> status is returned, the client should not treat the instance as a master or a slave and should instead pick another instance in the cluster to use, wait for the instance to transit from the <code class="literal">UNKNOWN</code> state, or undertake restorative action via systems admin.</p>
</td></tr></table></div>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>