<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>8.8. Patterns -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="cypher-comments.html" title="8.7. Comments" /><link rel="next" href="syntax-collections.html" title="8.9. Collections" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="8.8. Patterns" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-70838";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>8.8. Patterns</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="cypher-comments.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="query-syntax.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="syntax-collections.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="introduction-pattern"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">8.8. Patterns</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="introduction-pattern.html#_patterns_for_nodes">Patterns for nodes</a></span></li><li><span class="section"><a href="introduction-pattern.html#_patterns_for_related_nodes">Patterns for related nodes</a></span></li><li><span class="section"><a href="introduction-pattern.html#_labels">Labels</a></span></li><li><span class="section"><a href="introduction-pattern.html#_specifying_properties">Specifying properties</a></span></li><li><span class="section"><a href="introduction-pattern.html#_describing_relationships">Describing relationships</a></span></li><li><span class="section"><a href="introduction-pattern.html#_assigning_to_path_identifiers">Assigning to path identifiers</a></span></li></ul></div>

<p>Patterns and pattern-matching are at the very heart of Cypher, so being effective with Cypher requires a good understanding of patterns.</p>
<p>Using patterns, you describe the shape of the data you’re looking for. For example, in the <code class="literal">MATCH</code> clause you describe the shape with a pattern, and Cypher will figure out how to get that data for you.</p>
<p>The pattern describes the data using a form that is very similar to how one typically draws the shape of property graph data on a whiteboard: usually as circles (representing nodes) and arrows between them to represent relationships.</p>
<p>Patterns appear in multiple places in Cypher: in <code class="literal">MATCH</code>, <code class="literal">CREATE</code> and <code class="literal">MERGE</code> clauses, and in pattern expressions. Each of these
is described in more details in:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<a class="xref" href="query-match.html" title="10.1. Match">Section 10.1, “Match”</a>

</li><li class="listitem">

<a class="xref" href="query-optional-match.html" title="10.2. Optional Match">Section 10.2, “Optional Match”</a>

</li><li class="listitem">

<a class="xref" href="query-create.html" title="11.1. Create">Section 11.1, “Create”</a>

</li><li class="listitem">

<a class="xref" href="query-merge.html" title="11.2. Merge">Section 11.2, “Merge”</a>

</li><li class="listitem">

<a class="xref" href="query-where.html#query-where-patterns" title="Using patterns in WHERE">the section called “Using patterns in WHERE”</a>

</li></ul></div>
<section class="section" id="_patterns_for_nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Patterns for nodes</h3></div></div></div>

<p>The very simplest “shape” that can be described in a pattern is a node. A node is described using a pair of parentheses, and is typically given a name.
For example:</p>
<p><code class="literal"><code class="literal">(a)</code></code></p>
<p>This simple pattern describes a single node, and names that node using the identifier <code class="literal">a</code>.</p>
<p>Note that the parentheses may be omitted, but only when there are no labels or properties specified for the node pattern.</p>
</section>
<section class="section" id="_patterns_for_related_nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Patterns for related nodes</h3></div></div></div>

<p>More interesting is patterns that describe multiple nodes and relationships between them.
Cypher patterns describe relationships by employing an arrow between two nodes.
For example:</p>
<p><code class="literal"><code class="literal">(a)--&gt;(b)</code></code></p>
<p>This pattern describes a very simple data shape: two nodes, and a single relationship from one to the other.
In this example, the two nodes are both named as <code class="literal">a</code> and <code class="literal">b</code> respectively, and the relationship is “directed”: it goes from <code class="literal">a</code> to <code class="literal">b</code>.</p>
<p>This way of describing nodes and relationships can be extended to cover an arbitrary number of nodes and the relationships between them, for example:</p>
<p><code class="literal"><code class="literal">(a)--&gt;(b)&lt;--(c)</code></code></p>
<p>Such a series of connected nodes and relationships is called a "path".</p>
<p>Note that the naming of the nodes in these patterns is only necessary should one need to refer to the same node again, either later in the pattern or elsewhere in the Cypher query.
If this is not necessary then the name may be omitted, like so:</p>
<p><code class="literal"><code class="literal">(a)--&gt;()&lt;--(c)</code></code></p>
</section>
<section class="section" id="_labels"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Labels</h3></div></div></div>

<p>In addition to simply describing the shape of a node in the pattern, one can also describe attributes.
The most simple attribute that can be described in the pattern is a label that the node must have.
For example:</p>
<p><code class="literal"><code class="literal">(a:User)--&gt;(b)</code></code></p>
<p>One can also describe a node that has multiple labels:</p>
<p><code class="literal"><code class="literal">(a:User:Admin)--&gt;(b)</code></code></p>
</section>
<section class="section" id="_specifying_properties"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Specifying properties</h3></div></div></div>

<p>Nodes and relationships are the fundamental structures in a graph. Neo4j uses properties on both of these to allow for far richer models.</p>
<p>Properties can be expressed in patterns using a map-construct: curly brackets surrounding a number of key-expression pairs, separated by commas.
E.g. a node with two properties on it would look like:
<code class="literal"><code class="literal">(a { name: "Andres", sport: "Brazilian Ju-Jitsu" })</code>.</code></p>
<p>A relationship with expectations on it would could look like:
<code class="literal"><code class="literal">(a)-[{blocked: false}]-&gt;(b)</code>.</code></p>
<p>When properties appear in patterns, they add an additional constraint to the shape of the data.
In the case of a <code class="literal">CREATE</code> clause, the properties will be set in the newly created nodes and relationships.
In the case of a <code class="literal">MERGE</code> clause, the properties will be used as additional constraints on the shape any existing data must have (the specified properties must exactly match any existing data in the graph).
If no matching data is found, then <code class="literal">MERGE</code> behaves like <code class="literal">CREATE</code> and the properties will be set in the newly created nodes and relationships.</p>
<p>Note that patterns supplied to <code class="literal">CREATE</code> may use a single parameter to specify properties, e.g: <code class="literal">CREATE (node {paramName})</code>.
This is not possible with patterns used in other clauses, as Cypher needs to know the property names at the time the query is compiled, so that matching can be done effectively.</p>
</section>
<section class="section" id="_describing_relationships"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Describing relationships</h3></div></div></div>

<p>The simplest way to describe a relationship is by using the arrow between two nodes, as in the previous examples.
Using this technique, you can describe that the relationship should exist and the directionality of it.
If you don’t care about the direction of the relationship, the arrow head can be omitted, like so:</p>
<p><code class="literal"><code class="literal">(a)--(b)</code></code></p>
<p>As with nodes, relationships may also be given names.
In this case, a pair of square brackets is used to break up the arrow and the identifier is placed between.
For example:</p>
<p><code class="literal"><code class="literal">(a)-[r]-&gt;(b)</code></code></p>
<p>Much like labels on nodes, relationships can have types.
To describe a relationship with a specific type, you can specify this like so:</p>
<p><code class="literal"><code class="literal">(a)-[r:REL_TYPE]-&gt;(b)</code></code></p>
<p>Unlike labels, relationships can only have one type.
But if we’d like to describe some data such that the relationship could have any one of a set of types, then they can all be listed in the pattern, separating them with the pipe symbol <code class="literal">|</code> like this:</p>
<p><code class="literal"><code class="literal">(a)-[r:TYPE1|TYPE2]-&gt;(b)</code></code></p>
<p>Note that this form of pattern can only be used to describe existing data (ie. when using a pattern with <code class="literal">MATCH</code> or as an expression).
It will not work with <code class="literal">CREATE</code> or <code class="literal">MERGE</code>, since it’s not possible to create a relationship with multiple types.</p>
<p>As with nodes, the name of the relationship can always be omitted, in this case like so:</p>
<p><code class="literal"><code class="literal">(a)-[:REL_TYPE]-&gt;(b)</code></code></p>
<section class="section" id="_variable_length"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Variable length</h4></div></div></div>

<p>Rather than describing a long path using a sequence of many node and relationship descriptions in a pattern, many relationships (and the intermediate nodes) can be described by specifying a length in the relationship description of a pattern.
For example:</p>
<p><code class="literal"><code class="literal">(a)-[*2]-&gt;(b)</code></code></p>
<p>This describes a graph of three nodes and two relationship, all in one path (a path of length 2).
This is equivalent to:</p>
<p><code class="literal"><code class="literal">(a)--&gt;()--&gt;(b)</code></code></p>
<p>A range of lengths can also be specified: such relationship patterns are called “variable length relationships”.
For example:</p>
<p><code class="literal"><code class="literal">(a)-[*3..5]-&gt;(b)</code></code></p>
<p>This is a minimum length of 3, and a maximum of 5.
It describes a graph of either 4 nodes and 3 relationships, 5 nodes and 4 relationships or 6 nodes and 5 relationships, all connected together in a single path.</p>
<p>Either bound can be omitted. For example, to describe paths of length 3 or more, use:</p>
<p><code class="literal"><code class="literal">(a)-[*3..]-&gt;(b)</code></code></p>
<p>And to describe paths of length 5 or less, use:</p>
<p><code class="literal"><code class="literal">(a)-[*..5]-&gt;(b)</code></code></p>
<p>Both bounds can be omitted, allowing paths of any length to be described:</p>
<p><code class="literal"><code class="literal">(a)-[*]-&gt;(b)</code></code></p>
<p>As a simple example, let’s take the query below:</p>
<p><strong>Query. </strong>
</p><pre class="programlisting" data-lang="cypher">MATCH (me)-[:KNOWS*1..2]-(remote_friend)
WHERE me.name = "Filipa"
RETURN remote_friend.name</pre><p>
</p>
<div class="queryresult table" id="d5e4735"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><thead><tr><th>remote_friend.name</th></tr></thead><tfoot><tr><th>2 rows</th></tr></tfoot><tbody><tr><td><p><code class="literal">"Dilshad"</code></p></td></tr><tr><td><p><code class="literal">"Anders"</code></p></td></tr></tbody></table></div></div>
<p class="cypherconsole"><strong>Try this query live. </strong><span class="database">create (_0 {`name`:"Dilshad"})
create (_1 {`name`:"Emil"})
create (_2 {`name`:"Filipa"})
create (_3 {`name`:"Anders"})
create (_4 {`name`:"Becky"})
create (_5 {`name`:"Cesar"})
create _0-[:`KNOWS`]-&gt;_2
create _3-[:`KNOWS`]-&gt;_0
create _3-[:`KNOWS`]-&gt;_5
create _3-[:`KNOWS`]-&gt;_4
create _4-[:`KNOWS`]-&gt;_1
create _5-[:`KNOWS`]-&gt;_1
</span><span class="command"><strong>
 MATCH (me)-[:KNOWS*1..2]-(remote_friend)
 WHERE me.name = "Filipa"
 RETURN remote_friend.name</strong></span></p>
<p>This query finds data in the graph which a shape that fits the pattern: specifically a node (with the name property <code class="literal">Filipa</code>) and then the <code class="literal">KNOWS</code> related nodes, one or two steps out.
This is a typical example of finding first and second degree friends.</p>
<p>Note that variable length relationships can not be used with <code class="literal">CREATE</code> and <code class="literal">MERGE</code>.</p>
</section>
</section>
<section class="section" id="_assigning_to_path_identifiers"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Assigning to path identifiers</h3></div></div></div>

<p>As described above, a series of connected nodes and relationships is called a "path". Cypher allows paths to be named
using an identifer, like so:</p>
<p><code class="literal"><code class="literal">p = (a)-[*3..5]-&gt;(b)</code></code></p>
<p>You can do this in <code class="literal">MATCH</code>, <code class="literal">CREATE</code> and <code class="literal">MERGE</code>, but not when using patterns as expressions.</p>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>