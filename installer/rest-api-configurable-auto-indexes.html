<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>21.23. Configurable Legacy Automatic Indexing -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="rest-api-auto-indexes.html" title="21.22. Legacy Automatic Indexes" /><link rel="next" href="rest-api-wadl-support.html" title="21.24. WADL Support" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="21.23. Configurable Legacy Automatic Indexing" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-70838";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>21.23. Configurable Legacy Automatic Indexing</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="rest-api-auto-indexes.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="rest-api.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="rest-api-wadl-support.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="rest-api-configurable-auto-indexes"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">21.23. Configurable Legacy Automatic Indexing</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-create-an-auto-index-for-nodes-with-specific-configuration">Create an auto index for nodes with specific configuration</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-create-an-auto-index-for-relationships-with-specific-configuration">Create an auto index for relationships with specific configuration</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-get-current-status-for-autoindexing-on-nodes">Get current status for autoindexing on nodes</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-enable-node-autoindexing">Enable node autoindexing</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-lookup-list-of-properties-being-autoindexed">Lookup list of properties being autoindexed</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-add-a-property-for-autoindexing-on-nodes">Add a property for autoindexing on nodes</a></span></li><li><span class="section"><a href="rest-api-configurable-auto-indexes.html#rest-api-remove-a-property-for-autoindexing-on-nodes">Remove a property for autoindexing on nodes</a></span></li></ul></div>

<p>Out of the box auto-indexing supports exact matches since they are created with the default configuration (see <a class="xref" href="auto-indexing.html" title="37.12. Automatic Indexing">Section 37.12, “Automatic Indexing”</a>) the first time you access them. However it is possible to intervene in the lifecycle of the server before any auto indexes are created to change their configuration.</p>
<div class="admonitionblock Warning"><table><tr><td class="icon"><img alt="[Warning]" src="images/icons/admon/warning.svg" /></td><td class="content"><b>Warning</b><p>This approach <span class="emphasis"><em>cannot</em></span> be used on databases that already have auto-indexes established. To change the auto-index configuration existing indexes would have to be deleted first, so be careful!</p></td></tr></table></div>
<div class="admonitionblock Caution"><table><tr><td class="icon"><img alt="[Caution]" src="images/icons/admon/caution.svg" /></td><td class="content"><b>Caution</b><p>This technique works, but it is not particularly pleasant. Future versions of Neo4j may remove this loophole in favour of a better structured feature for managing auto-indexing configurations.</p></td></tr></table></div>
<p>Auto-indexing must be enabled through configuration before we can create or configure them. Firstly ensure that you’ve added some config like this into your server’s <span class="emphasis"><em>conf/neo4j.properties</em></span> file:</p>
<pre class="programlisting" data-lang="plain">node_auto_indexing=true
relationship_auto_indexing=true
node_keys_indexable=name,phone
relationship_keys_indexable=since</pre>
<p>The <code class="literal">node_auto_indexing</code> and <code class="literal">relationship_auto_indexing</code> settings turn auto-indexing on for nodes and relationships respectively. The <code class="literal">node_keys_indexable</code> key allows you to specify a comma-separated list of node property keys to be indexed. The <code class="literal">relationship_keys_indexable</code> does the same for relationship property keys.</p>
<p>Next start the server as usual by invoking the start script as described in <a class="xref" href="server-installation.html" title="23.2. Server Installation">Section 23.2, “Server Installation”</a>.</p>
<p>Next we have to pre-empt the creation of an auto-index, by telling the server to create an apparently manual index which has the same name as the node (or relationship) auto-index. For example, in this case we’ll create a node auto index whose name is <code class="literal">node_auto_index</code>, like so:</p>
<section class="section" id="rest-api-create-an-auto-index-for-nodes-with-specific-configuration"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create an auto index for nodes with specific configuration</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/node/</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "name" : "node_auto_index",
  "config" : {
    "type" : "fulltext",
    "provider" : "lucene"
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/node/node_auto_index/</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "template" : "http://localhost:7474/db/data/index/node/node_auto_index/{key}/{value}",
  "type" : "fulltext",
  "provider" : "lucene"
}</pre>
<p>If you require configured auto-indexes for relationships, the approach is similar:</p>
</section>
<section class="section" id="rest-api-create-an-auto-index-for-relationships-with-specific-configuration"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Create an auto index for relationships with specific configuration</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/relationship/</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "name" : "relationship_auto_index",
  "config" : {
    "type" : "fulltext",
    "provider" : "lucene"
  }
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/index/relationship/relationship_auto_index/</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "template" : "http://localhost:7474/db/data/index/relationship/relationship_auto_index/{key}/{value}",
  "type" : "fulltext",
  "provider" : "lucene"
}</pre>
<p>In case you’re curious how this works, on the server side it triggers the creation of an index which happens to have the same name as the auto index that the database would create for itself. Now when we interact with the database, the index thinks the index is already created so the state machine skips over that step and just gets on with normal day-to-day auto-indexing.</p>
<div class="admonitionblock Caution"><table><tr><td class="icon"><img alt="[Caution]" src="images/icons/admon/caution.svg" /></td><td class="content"><b>Caution</b><p>You have to do this early in your server lifecycle, before any normal auto indexes are created.</p></td></tr></table></div>
<p>There are a few REST calls providing a REST interface to the <a class="ulink" href="javadocs/org/neo4j/graphdb/index/AutoIndexer.html" target="_blank">AutoIndexer</a> component. The following REST calls work both, for <code class="literal">node</code> and <code class="literal">relationship</code> by simply changing the respective part of the URL.</p>
</section>
<section class="section" id="rest-api-get-current-status-for-autoindexing-on-nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Get current status for autoindexing on nodes</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">GET</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/auto/node/status</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">false</pre>
</section>
<section class="section" id="rest-api-enable-node-autoindexing"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Enable node autoindexing</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">PUT</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/auto/node/status</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">true</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">204:</code></strong></span> <code class="literal">No Content</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript"></pre>
</section>
<section class="section" id="rest-api-lookup-list-of-properties-being-autoindexed"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Lookup list of properties being autoindexed</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">GET</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/auto/node/properties</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">[ "some-property" ]</pre>
</section>
<section class="section" id="rest-api-add-a-property-for-autoindexing-on-nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Add a property for autoindexing on nodes</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/auto/node/properties</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">myProperty1</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">204:</code></strong></span> <code class="literal">No Content</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript"></pre>
</section>
<section class="section" id="rest-api-remove-a-property-for-autoindexing-on-nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Remove a property for autoindexing on nodes</h3></div></div></div>

<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">DELETE</code></strong></span>  <code class="literal">http://localhost:7474/db/data/index/auto/node/properties/myProperty1</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">204:</code></strong></span> <code class="literal">No Content</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript"></pre>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>