<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4.2. Graphs, Patterns, and Cypher -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="cypher-motivation.html" title="4.1. Background and Motivation" /><link rel="next" href="cypherdoc-patterns-in-practice.html" title="4.3. Patterns in Practice" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="4.2. Graphs, Patterns, and Cypher" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-75824";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>4.2. Graphs, Patterns, and Cypher</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="cypher-motivation.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="cypher-getting-started.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="cypherdoc-patterns-in-practice.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="cypher-intro-patterns"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">4.2. Graphs, Patterns, and Cypher</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="cypher-intro-patterns.html#_nodes_relationships_and_patterns">Nodes, Relationships, and Patterns</a></span></li><li><span class="section"><a href="cypher-intro-patterns.html#_cypher_concepts">Cypher Concepts</a></span></li><li><span class="section"><a href="cypher-intro-patterns.html#_clauses">Clauses</a></span></li></ul></div>

<section class="section" id="_nodes_relationships_and_patterns"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Nodes, Relationships, and Patterns</h3></div></div></div>

<p>Neo4j’s Property Graphs are composed of nodes and relationships, either of which may have properties (ie, attributes).
Nodes represent entities (eg, concepts, events, places, things);
relationships (which may be directed) connect pairs of nodes.</p>
<p>However, nodes and relationships are simply low-level building blocks.
The real strength of the Property Graph lies in its ability to encode <span class="emphasis"><em>patterns</em></span> of connected nodes and relationships.
A single node or relationship typically encodes very little information,
but a pattern of nodes and relationships can encode arbitrarily complex ideas.</p>
<p>Cypher, Neo4j’s query language, is strongly based on patterns.
Specifically, patterns are used to match desired graph structures.
Once a matching structure has been found (or created), Neo4j can use it for further processing.</p>
<section class="section" id="_simple_and_complex_patterns"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Simple and Complex Patterns</h4></div></div></div>

<p>A simple pattern, which has only a single relationship, connects a pair of nodes (or, occasionally, a node to itself).
For example, <span class="emphasis"><em>a Person</em></span> <code class="literal">LIVES_IN</code> <span class="emphasis"><em>a City</em></span> or <span class="emphasis"><em>a City is</em></span> <code class="literal">PART_OF</code> <span class="emphasis"><em>a Country</em></span>.</p>
<p>Complex patterns, using multiple relationships, can express arbitrarily complex concepts and support a variety of interesting use cases.
For example, we might want to match instances where <span class="emphasis"><em>a Person</em></span>  <code class="literal">LIVES_IN</code> <span class="emphasis"><em>a Country</em></span>.
The following Cypher code combines two simple patterns into a (mildly) complex pattern which performs this match:</p>
<pre class="programlisting" data-lang="cypher">(:Person) -[:LIVES_IN]-&gt; (:City) -[:PART_OF]-&gt; (:Country)</pre>
<p>Pattern recognition is fundamental to the way that the brain works.
Consequently, humans are very good at working with patterns.
When patterns are presented visually (eg, in a diagram or map),
humans can use them to recognize, specify, and understand concepts.
As a pattern-based language, Cypher takes advantage of this capability.</p>
</section>
</section>
<section class="section" id="_cypher_concepts"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Cypher Concepts</h3></div></div></div>

<p>Like <a class="ulink" href="https://en.wikipedia.org/wiki/SQL" target="_blank">SQL</a> (used in <a class="ulink" href="https://en.wikipedia.org/wiki/Relational_database_management_system" target="_blank">relational databases</a>),
Cypher is a textual, declarative query language.
It uses a form of <a class="ulink" href="https://en.wikipedia.org/wiki/ASCII_art" target="_blank">ASCII art</a> to represent graph-related patterns.
SQL-like clauses and keywords (eg, <code class="literal">MATCH</code>, <code class="literal">WHERE</code>, <code class="literal">DELETE</code>) are used to combine these patterns and specify desired actions.</p>
<p>This combination tells Neo4j which patterns to match and what to do with the matching items (eg, nodes, relationships, paths, collections).
However, as a <a class="ulink" href="https://en.wikipedia.org/wiki/Declarative_programming" target="_blank">declarative</a> language, Cypher does <span class="emphasis"><em>not</em></span> tell Neo4j how to find nodes, traverse relationships, etc.
(This level of control is available from Neo4j’s <a class="ulink" href="https://en.wikipedia.org/wiki/Java_(programming_language)" target="_blank">Java</a> <a class="ulink" href="https://en.wikipedia.org/wiki/Application_programming_interface" target="_blank">APIs</a>, see <a class="xref" href="server-unmanaged-extensions.html" title="35.2. Unmanaged Extensions">Section 35.2, “Unmanaged Extensions”</a>)</p>
<p>Diagrams made up of icons and arrows are commonly used to visualize graphs;
textual annotations provide labels, define properties, etc.
Cypher’s ASCII-art syntax formalizes this approach, while adapting it to the limitations of text.</p>
<section class="section" id="_node_syntax"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Node Syntax</h4></div></div></div>

<p>Cypher uses a pair of parentheses (usually containing a text string) to represent a node, eg: <code class="literal">()</code>, <code class="literal">(foo)</code>.
This is reminiscent of a circle or a rectangle with rounded end caps.
Here are some ASCII-art encodings for example Neo4j nodes, providing varying types and amounts of detail:</p>
<pre class="programlisting" data-lang="cypher">()
(matrix)
(:Movie)
(matrix:Movie)
(matrix:Movie {title: "The Matrix"})
(matrix:Movie {title: "The Matrix", released: 1997})</pre>
<p>The simplest form, <code class="literal">()</code>, represents an anonymous, uncharacterized node.
If we want to refer to the node elsewhere, we can add an identifier, eg: <code class="literal">(matrix)</code>.
Identifiers are restricted (ie, scoped) to a single statement:
an identifier may have different (or no) meaning in another statement.</p>
<p>The <code class="literal">Movie</code> label (prefixed in use with a colon) declares the node’s type.
This restricts the pattern, keeping it from matching (say) a structure with an <code class="literal">Actor</code> node in this position.
Neo4j’s node indexes also use labels: each index is specific to the combination of a label and a property.</p>
<p>The node’s properties (eg, <code class="literal">title</code>) are represented as a list of key/value pairs, enclosed within a pair of braces, eg: <code class="literal">{...}</code>.
Properties can be used to store information and/or restrict patterns.
For example, we could match nodes whose <code class="literal">title</code> is "The Matrix".</p>
</section>
<section class="section" id="_relationship_syntax"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Relationship Syntax</h4></div></div></div>

<p>Cypher uses a pair of dashes (<code class="literal">--</code>) to represent an undirected relationship.
Directed relationships have an arrowhead at one end (eg, <code class="literal">&lt;--</code>, <code class="literal">--&gt;</code>).
Bracketed expressions (eg: <code class="literal">[...]</code>) can be used to add details.
This may include identifiers, properties, and/or type information, eg:</p>
<pre class="programlisting" data-lang="cypher">--&gt;
-[role]-&gt;
-[:ACTED_IN]-&gt;
-[role:ACTED_IN]-&gt;
-[role:ACTED_IN {roles: ["Neo"]}]-&gt;</pre>
<p>The syntax and semantics found within a relationship’s bracket pair are very similar to those used between a node’s parentheses.
An identifier (eg, <code class="literal">role</code>) can be defined, to be used elsewhere in the statement.
The relationship’s type (eg, <code class="literal">ACTED_IN</code>) is analogous to the node’s label.
The properties (eg, <code class="literal">roles</code>) are entirely equivalent to node properties.
(Note that the value of a property may be an array.)</p>
</section>
<section class="section" id="_pattern_syntax"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Pattern Syntax</h4></div></div></div>

<p>Combining the syntax for nodes and relationships, we can express patterns.
The following could be a simple pattern (or fact) in this domain:</p>
<pre class="programlisting" data-lang="cypher">(keanu:Person:Actor {name:  "Keanu Reeves"} )
-[role:ACTED_IN     {roles: ["Neo"] } ]-&gt;
(matrix:Movie       {title: "The Matrix"} )</pre>
<p>Like with node labels, the relationship type <code class="literal">ACTED_IN</code> is added as a symbol, prefixed with a colon: <code class="literal">:ACTED_IN</code>.
Identifiers (eg, <code class="literal">role</code>) can be used elsewhere in the statement to refer to the relationship.
Node and relationship properties use the same notation.
In this case, we used an array property for the <code class="literal">roles</code>, allowing multiple roles to be specified.</p>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Pattern Nodes vs. Database Nodes</b>

<p>When a node is used in a pattern, it <span class="emphasis"><em>describes</em></span> zero or more nodes in the database.
Similarly, each pattern describes zero or more paths of nodes and relationships.</p>
</td></tr></table></div>
</section>
<section class="section" id="_pattern_identifiers"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Pattern Identifiers</h4></div></div></div>

<p>To increase modularity and reduce repetition, Cypher allows patterns to be  assigned to identifiers.
This allow the matching paths to be inspected, used in other expressions, etc.</p>
<pre class="programlisting" data-lang="cypher">acted_in = (:Person)-[:ACTED_IN]-&gt;(:Movie)</pre>
<p>The <code class="literal">acted_in</code> variable would contain two nodes and the connecting relationship for each path that was found or created.
There are a number of functions to access details of a path, including <code class="literal">nodes(path)</code>, <code class="literal">rels(path)</code> (same as <code class="literal">relationships(path)</code>), and <code class="literal">length(path)</code>.</p>
</section>
</section>
<section class="section" id="_clauses"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Clauses</h3></div></div></div>

<p>Cypher statements typically have multiple <span class="emphasis"><em>clauses</em></span>, each of which performs a specific task, eg:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

create and match patterns in the graph

</li><li class="listitem">

filter, project, sort, or paginate results

</li><li class="listitem">

connect/compose partial statements

</li></ul></div>
<p>By combining Cypher clauses, we can compose more complex statements that express what we want to know or create.
Neo4j then figures out how to achieve the desired goal in an efficient manner.</p>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>