<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>37.2. Traversal Framework Java API -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="tutorial-traversal-concepts.html" title="37.1. Main concepts" /><link rel="next" href="indexing.html" title="Chapter 38. Legacy Indexing" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="37.2. Traversal Framework Java API" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-75824";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.10.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>37.2. Traversal Framework Java API</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="tutorial-traversal-concepts.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="tutorial-traversal.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="indexing.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="tutorial-traversal-java-api"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">37.2. Traversal Framework Java API</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="tutorial-traversal-java-api.html#_traversaldescription">TraversalDescription</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_evaluator">Evaluator</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_traverser">Traverser</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_uniqueness">Uniqueness</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_order_8201_8212_8201_how_to_move_through_branches">Order — How to move through branches?</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_branchselector">BranchSelector</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_path">Path</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_pathexpander_relationshipexpander">PathExpander/RelationshipExpander</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#_expander">Expander</a></span></li><li><span class="section"><a href="tutorial-traversal-java-api.html#examples-how-to-use-the-traversal-framework">How to use the Traversal framework</a></span></li></ul></div>

<p>The traversal framework consists of a few main interfaces in addition to <code class="literal">Node</code> and <code class="literal">Relationship</code>: <code class="literal">TraversalDescription</code>, <code class="literal">Evaluator</code>, <code class="literal">Traverser</code> and <code class="literal">Uniqueness</code> are the main ones.
The <code class="literal">Path</code> interface also has a special purpose in traversals, since it is used to represent a position in the graph when evaluating that position.
Furthermore the <code class="literal">PathExpander</code> (replacing <code class="literal">RelationshipExpander</code> and <code class="literal">Expander</code>) interface is central to traversals, but users of the API rarely need to implement it.
There are also a set of interfaces for advanced use, when explicit control over the traversal order is required: <code class="literal">BranchSelector</code>, <code class="literal">BranchOrderingPolicy</code> and <code class="literal">TraversalBranch</code>.</p>
<section class="section" id="_traversaldescription"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">TraversalDescription</h3></div></div></div>

<p>The <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html" target="_blank"><code class="literal">TraversalDescription</code></a> is the main interface used for defining and initializing traversals.
It is not meant to be implemented by users of the traversal framework, but rather to be provided by the implementation of the traversal framework as a way for the user to describe traversals.
<code class="literal">TraversalDescription</code> instances are immutable and its methods returns a new <code class="literal">TraversalDescription</code> that is modified compared to the object the method was invoked on with the arguments of the method.</p>
<section class="section" id="_relationships"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Relationships</h4></div></div></div>

<p>Adds a relationship type to the list of relationship types to traverse.
By default that list is empty and it means that it will traverse <span class="emphasis"><em>all relationships</em></span>, regardless of type.
If one or more relationships are added to this list <span class="emphasis"><em>only the added</em></span> types will be traversed.
There are two methods, one <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#relationships" target="_blank">including direction</a> and another one <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#relationships" target="_blank">excluding direction</a>, where the latter traverses relationships in <a class="ulink" href="javadocs/org/neo4j/graphdb/Direction.html#BOTH" target="_blank">both directions</a>.</p>
</section>
</section>
<section class="section" id="_evaluator"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Evaluator</h3></div></div></div>

<p><a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Evaluator.html" target="_blank"><code class="literal">Evaluator</code></a>s are used for deciding, at each position (represented as a <code class="literal">Path</code>): should the traversal continue, and/or should the node be included in the result.
Given a <code class="literal">Path</code>, it asks for one of four actions for that branch of the traversal:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<code class="literal">Evaluation.INCLUDE_AND_CONTINUE</code>: Include this node in the result and continue the traversal

</li><li class="listitem">

<code class="literal">Evaluation.INCLUDE_AND_PRUNE</code>: Include this node in the result, but don’t continue the traversal

</li><li class="listitem">

<code class="literal">Evaluation.EXCLUDE_AND_CONTINUE</code>: Exclude this node from the result, but continue the traversal

</li><li class="listitem">

<code class="literal">Evaluation.EXCLUDE_AND_PRUNE</code>: Exclude this node from the result and don’t continue the traversal

</li></ul></div>
<p>More than one evaluator can be added. Note that evaluators will be called for all positions the traverser encounters, even for the start node.</p>
</section>
<section class="section" id="_traverser"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Traverser</h3></div></div></div>

<p>The <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Traverser.html" target="_blank"><code class="literal">Traverser</code></a> object is the result of invoking <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#traverse(org.neo4j.graphdb.Node)" target="_blank"><code class="literal">traverse()</code></a> of a TraversalDescription object.
It represents a traversal positioned in the graph, and a specification of the format of the result.
The actual traversal is performed lazily each time the <code class="literal">next()</code>-method of the iterator of the <code class="literal">Traverser</code> is invoked.</p>
</section>
<section class="section" id="_uniqueness"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Uniqueness</h3></div></div></div>

<p>Sets the rules for how positions can be revisited during a traversal as stated in <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Uniqueness.html" target="_blank"><code class="literal">Uniqueness</code></a>.
Default if not set is <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Uniqueness.html#NODE_GLOBAL" target="_blank"><code class="literal">NODE_GLOBAL</code></a>.</p>
<p>A Uniqueness can be supplied to the TraversalDescription to dictate under what circumstances a traversal may revisit the same position in the graph. The various uniqueness levels that can be used in Neo4j are:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<code class="literal">NONE</code>: Any position in the graph may be revisited.

</li><li class="listitem">

<code class="literal">NODE_GLOBAL</code> uniqueness: No node in the entire graph may be visited more than once. This could potentially consume a lot of memory since it requires keeping an in-memory data structure remembering all the visited nodes.

</li><li class="listitem">

<code class="literal">RELATIONSHIP_GLOBAL</code> uniqueness: no relationship in the entire graph may be visited more than once. For the same reasons as <code class="literal">NODE_GLOBAL</code> uniqueness, this could use up a lot of memory. But since graphs typically have a larger number of relationships than nodes, the memory overhead of this uniqueness level could grow even quicker.

</li><li class="listitem">

<code class="literal">NODE_PATH</code> uniqueness: A node may not occur previously in the path reaching up to it.

</li><li class="listitem">

<code class="literal">RELATIONSHIP_PATH</code> uniqueness: A relationship may not occur previously in the path reaching up to it.

</li><li class="listitem">

<code class="literal">NODE_RECENT</code> uniqueness: Similar to <code class="literal">NODE_GLOBAL</code> uniqueness in that there is a global collection of visited nodes each position is checked against. This uniqueness level does however have a cap on how much memory it may consume in the form of a collection that only contains the most recently visited nodes. The size of this collection can be specified by providing a number as the second argument to the TraversalDescription.uniqueness()-method along with the uniqueness level.

</li><li class="listitem">

<code class="literal">RELATIONSHIP_RECENT</code> uniqueness: Works like <code class="literal">NODE_RECENT</code> uniqueness, but with relationships instead of nodes.

</li></ul></div>
<section class="section" id="_depth_first_breadth_first"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Depth First / Breadth First</h4></div></div></div>

<p>These are convenience methods for setting preorder <a class="ulink" href="http://en.wikipedia.org/wiki/Depth-first_search" target="_blank">depth-first</a>/ <a class="ulink" href="http://en.wikipedia.org/wiki/Breadth-first_search" target="_blank">breadth-first</a> <code class="literal">BranchSelector</code>|<code class="literal">ordering</code> policies.
The same result can be achieved by calling the <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#order" target="_blank"><code class="literal">order</code></a> method with ordering policies from <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/BranchOrderingPolicies.html" target="_blank"><code class="literal">BranchOrderingPolicies</code></a>, or to write your own <code class="literal">BranchSelector</code>/<code class="literal">BranchOrderingPolicy</code> and pass in.</p>
</section>
</section>
<section class="section" id="_order_8201_8212_8201_how_to_move_through_branches"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Order — How to move through branches?</h3></div></div></div>

<p>A more generic version of depthFirst/breadthFirst methods in that it allows an arbitrary <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/BranchOrderingPolicy.html" target="_blank"><code class="literal">BranchOrderingPolicy</code></a> to be injected into the description.</p>
</section>
<section class="section" id="_branchselector"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">BranchSelector</h3></div></div></div>

<p>A <code class="literal">BranchSelector</code>/<code class="literal">BranchOrderingPolicy</code> is used for selecting which branch of the traversal to attempt next.
This is used for implementing traversal orderings.
The traversal framework provides a few basic ordering implementations:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<code class="literal">BranchOrderingPolicies.PREORDER_DEPTH_FIRST</code>: Traversing depth first, visiting each node before visiting its child nodes.

</li><li class="listitem">

<code class="literal">BranchOrderingPolicies.POSTORDER_DEPTH_FIRST</code>: Traversing depth first, visiting each node after visiting its child nodes.

</li><li class="listitem">

<code class="literal">BranchOrderingPolicies.PREORDER_BREADTH_FIRST</code>: Traversing breadth first, visiting each node before visiting its child nodes.

</li><li class="listitem">

<code class="literal">BranchOrderingPolicies.POSTORDER_BREADTH_FIRST</code>: Traversing breadth first, visiting each node after visiting its child nodes.

</li></ul></div>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>Please note that breadth first traversals have a higher memory overhead than depth first traversals.</p></td></tr></table></div>
<p><code class="literal">BranchSelector</code>s carries state and hence needs to be uniquely instantiated for each traversal.
Therefore it is supplied to the <code class="literal">TraversalDescription</code> through a <code class="literal">BranchOrderingPolicy</code> interface, which is a factory of <code class="literal">BranchSelector</code> instances.</p>
<p>A user of the Traversal framework rarely needs to implement his own <code class="literal">BranchSelector</code> or <code class="literal">BranchOrderingPolicy</code>, it is provided to let graph algorithm implementors provide their own traversal orders.
The Neo4j Graph Algorithms package contains for example a <code class="literal">BestFirst</code> order <code class="literal">BranchSelector</code>/<code class="literal">BranchOrderingPolicy</code> that is used in BestFirst search algorithms such as A* and Dijkstra.</p>
<section class="section" id="_branchorderingpolicy"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">BranchOrderingPolicy</h4></div></div></div>

<p>A factory for creating <code class="literal">BranchSelector</code>s to decide in what order branches are returned (where a branch’s position is represented as a <a class="ulink" href="javadocs/org/neo4j/graphdb/Path.html" target="_blank"><code class="literal">Path</code></a> from the start node to the current node).
Common policies are <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#depthFirst()" target="_blank"><code class="literal">depth-first</code></a> and <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#breadthFirst()" target="_blank"><code class="literal">breadth-first</code></a> and that’s why there are convenience methods for those.
For example, calling <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html#depthFirst()" target="_blank"><code class="literal">TraversalDescription#depthFirst()</code></a> is equivalent to:</p>
<pre class="programlisting" data-lang="java">description.order( BranchOrderingPolicies.PREORDER_DEPTH_FIRST );</pre>
</section>
<section class="section" id="_traversalbranch"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">TraversalBranch</h4></div></div></div>

<p>An object used by the BranchSelector to get more branches from a certain branch. In essence these are a composite of a Path and a RelationshipExpander that can be used to get new <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalBranch.html" target="_blank"><code class="literal">TraversalBranch</code></a>es from the current one.</p>
</section>
</section>
<section class="section" id="_path"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Path</h3></div></div></div>

<p>A <a class="ulink" href="javadocs/org/neo4j/graphdb/Path.html" target="_blank"><code class="literal">Path</code></a> is a general interface that is part of the Neo4j API.
In the traversal API of Neo4j the use of Paths are twofold.
Traversers can return their results in the form of the Paths of the visited positions in the graph that are marked for being returned.
Path objects are also used in the evaluation of positions in the graph, for determining if the traversal should continue from a certain point or not, and whether a certain position should be included in the result set or not.</p>
</section>
<section class="section" id="_pathexpander_relationshipexpander"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">PathExpander/RelationshipExpander</h3></div></div></div>

<p>The traversal framework use <code class="literal">PathExpander</code>s (replacing <code class="literal">RelationshipExpander</code>) to discover the relationships that should be followed from a particular path to further branches in the traversal.</p>
</section>
<section class="section" id="_expander"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Expander</h3></div></div></div>

<p>A more generic version of relationships where a <code class="literal">RelationshipExpander</code> is injected, defining all relationships to be traversed for any given node.</p>
<p>The <code class="literal">Expander</code> interface is an extension of the <code class="literal">RelationshipExpander</code> interface that makes it possible to build customized versions of an <code class="literal">Expander</code>.
The implementation of <code class="literal">TraversalDescription</code> uses this to provide methods for defining which relationship types to traverse, this is the usual way a user of the API would define a <code class="literal">RelationshipExpander</code> — by building it internally in the <code class="literal">TraversalDescription</code>.</p>
<p>All the RelationshipExpanders provided by the Neo4j traversal framework also implement the Expander interface.
For a user of the traversal API it is easier to implement the PathExpander/RelationshipExpander interface, since it only contains one method — the method for getting the relationships from a path/node, the methods that the Expander interface adds are just for building new Expanders.</p>
</section>
<section class="section" id="examples-how-to-use-the-traversal-framework"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">How to use the Traversal framework</h3></div></div></div>

<p>A
<a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html" target="_blank">traversal description</a> is built using a
fluent interface and such a description can then spawn
<a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Traverser.html" target="_blank">traversers</a>.</p>
<div class="figure" id="d5e31642"><p class="title"><strong>Figure 37.1. Traversal Example Graph</strong></p><div class="figure-contents">
<a class="ulink" href="images/Traversal-Example-Graph-how-to-use-the-Traversal-framework.svg" target="_blank">
<span class="inlinemediaobject"><img src="images/Traversal-Example-Graph-how-to-use-the-Traversal-framework.svg" alt="Traversal-Example-Graph-how-to-use-the-Traversal-framework.svg" /></span>
</a>
</div></div>
<p>With the definition of the <code class="literal">RelationshipTypes</code> as</p>
<pre class="programlisting" data-lang="java">private enum Rels implements RelationshipType
{
    LIKES, KNOWS
}
</pre>
<p>The graph can be traversed with for example the following traverser, starting at the “Joe” node:</p>
<pre class="programlisting" data-lang="java">for ( Path position : db.traversalDescription()
        .depthFirst()
        .relationships( Rels.KNOWS )
        .relationships( Rels.LIKES, Direction.INCOMING )
        .evaluator( Evaluators.toDepth( 5 ) )
        .traverse( node ) )
{
    output += position + "\n";
}
</pre>
<p>The traversal will output:</p>
<pre class="programlisting" data-lang="plain">(6)
(6)&lt;--[LIKES,1]--(3)
(6)&lt;--[LIKES,1]--(3)--[KNOWS,6]--&gt;(0)
(6)&lt;--[LIKES,1]--(3)--[KNOWS,6]--&gt;(0)--[KNOWS,4]--&gt;(5)
(6)&lt;--[LIKES,1]--(3)--[KNOWS,6]--&gt;(0)--[KNOWS,4]--&gt;(5)--[KNOWS,3]--&gt;(4)
(6)&lt;--[LIKES,1]--(3)--[KNOWS,6]--&gt;(0)--[KNOWS,4]--&gt;(5)--[KNOWS,3]--&gt;(4)--[KNOWS,2]--&gt;(1)
(6)&lt;--[LIKES,1]--(3)--[KNOWS,6]--&gt;(0)&lt;--[KNOWS,5]--(2)</pre>
<p>Since <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/TraversalDescription.html" target="_blank"><code class="literal">TraversalDescription</code></a>s
are immutable it is also useful to create template descriptions which holds common
settings shared by different traversals. For example, let’s start with this traverser:</p>
<pre class="programlisting" data-lang="java">friendsTraversal = db.traversalDescription()
        .depthFirst()
        .relationships( Rels.KNOWS )
        .uniqueness( Uniqueness.RELATIONSHIP_GLOBAL );
</pre>
<p>This traverser would yield the following output (we will keep starting from the “Joe” node):</p>
<pre class="programlisting" data-lang="plain">(6)
(6)--[KNOWS,0]--&gt;(1)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)&lt;--[KNOWS,4]--(0)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)&lt;--[KNOWS,4]--(0)&lt;--[KNOWS,6]--(3)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)&lt;--[KNOWS,4]--(0)&lt;--[KNOWS,5]--(2)</pre>
<p>Now let’s create a new traverser from it, restricting depth to three:</p>
<pre class="programlisting" data-lang="java">for ( Path path : friendsTraversal
        .evaluator( Evaluators.toDepth( 3 ) )
        .traverse( node ) )
{
    output += path + "\n";
}
</pre>
<p>This will give us the following result:</p>
<pre class="programlisting" data-lang="plain">(6)
(6)--[KNOWS,0]--&gt;(1)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)</pre>
<p>Or how about from depth two to four?
That’s done like this:</p>
<pre class="programlisting" data-lang="java">for ( Path path : friendsTraversal
        .evaluator( Evaluators.fromDepth( 2 ) )
        .evaluator( Evaluators.toDepth( 4 ) )
        .traverse( node ) )
{
    output += path + "\n";
}
</pre>
<p>This traversal gives us:</p>
<pre class="programlisting" data-lang="plain">(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)
(6)--[KNOWS,0]--&gt;(1)&lt;--[KNOWS,2]--(4)&lt;--[KNOWS,3]--(5)&lt;--[KNOWS,4]--(0)</pre>
<p>For various useful evaluators, see the
<a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Evaluators.html" target="_blank">Evaluators</a> Java API
or simply implement the
<a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Evaluator.html" target="_blank">Evaluator</a> interface yourself.</p>
<p>If you’re not interested in the <a class="ulink" href="javadocs/org/neo4j/graphdb/Path.html" target="_blank"><code class="literal">Path</code></a>s,
but the <a class="ulink" href="javadocs/org/neo4j/graphdb/Node.html" target="_blank"><code class="literal">Node</code></a>s
you can transform the traverser into an iterable of <a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Traverser.html#nodes()" target="_blank">nodes</a>
like this:</p>
<pre class="programlisting" data-lang="java">for ( Node currentNode : friendsTraversal
        .traverse( node )
        .nodes() )
{
    output += currentNode.getProperty( "name" ) + "\n";
}
</pre>
<p>In this case we use it to retrieve the names:</p>
<pre class="programlisting" data-lang="plain">Joe
Sara
Peter
Dirk
Lars
Lisa
Ed</pre>
<p><a class="ulink" href="javadocs/org/neo4j/graphdb/traversal/Traverser.html#relationships()" target="_blank">Relationships</a>
are fine as well, here’s how to get them:</p>
<pre class="programlisting" data-lang="java">for ( Relationship relationship : friendsTraversal
        .traverse( node )
        .relationships() )
{
    output += relationship.getType().name() + "\n";
}
</pre>
<p>Here the relationship types are written, and we get:</p>
<pre class="programlisting" data-lang="plain">KNOWS
KNOWS
KNOWS
KNOWS
KNOWS
KNOWS</pre>
<div class="admonitionblock Tip"><table><tr><td class="icon"><img alt="[Tip]" src="images/icons/admon/tip.svg" /></td><td class="content"><b>Tip</b><p>The source code for the traversers in this example is available at:
<a class="ulink" href="https://github.com/neo4j/neo4j/blob/master/community/embedded-examples/src/main/java/org/neo4j/examples/TraversalExample.java" target="_blank">TraversalExample.java</a></p></td></tr></table></div>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>