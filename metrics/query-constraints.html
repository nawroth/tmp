<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>14.2. Constraints -  - The Neo4j Manual v2.3-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="query-schema-index.html" title="14.1. Indexes" /><link rel="next" href="query-schema-statistics.html" title="14.3. Statistics" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="14.2. Constraints" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-73202";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.1/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.6.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Section table of contents -->

<script type="text/javascript" src="js/toc.js"></script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.3-SNAPSHOT</span><span>14.2. Constraints</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="query-schema-index.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="cypher-schema.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="query-schema-statistics.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="query-constraints"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">14.2. Constraints</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="query-constraints.html#query-constraints-unique-nodes">Unique node property constraints</a></span><ul><li><span class="section"><a href="query-constraints.html#constraints-create-uniqueness-constraint">Create uniqueness constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-drop-uniqueness-constraint">Drop uniqueness constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-node-that-complies-with-unique-property-constraints">Create a node that complies with unique property constraints</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-node-that-breaks-a-unique-property-constraint">Create a node that breaks a unique property constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-failure-to-create-a-unique-property-constraint-due-to-conflicting-nodes">Failure to create a unique property constraint due to conflicting nodes</a></span></li></ul></li><li><span class="section"><a href="query-constraints.html#query-constraints-prop-exist-nodes">Node property existence constraints</a></span><ul><li><span class="section"><a href="query-constraints.html#constraints-create-node-property-existence-constraint">Create node property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-drop-node-property-existence-constraint">Drop node property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-node-that-complies-with-property-existence-constraints">Create a node that complies with property existence constraints</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-node-that-breaks-a-property-existence-constraint">Create a node that breaks a property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-removing-an-existence-constrained-node-property">Removing an existence constrained node property</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-failure-to-create-a-node-property-existence-constraint-due-to-existing-node">Failure to create a node property existence constraint due to existing node</a></span></li></ul></li><li><span class="section"><a href="query-constraints.html#query-constraints-prop-exist-rels">Relationship property existence constraints</a></span><ul><li><span class="section"><a href="query-constraints.html#constraints-create-relationship-property-existence-constraint">Create relationship property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-drop-relationship-property-existence-constraint">Drop relationship property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-relationship-that-complies-with-property-existence-constraints">Create a relationship that complies with property existence constraints</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-create-a-relationship-that-breaks-a-property-existence-constraint">Create a relationship that breaks a property existence constraint</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-removing-an-existence-constrained-relationship-property">Removing an existence constrained relationship property</a></span></li><li><span class="section"><a href="query-constraints.html#constraints-failure-to-create-a-relationship-property-existence-constraint-due-to-existing-relationship">Failure to create a relationship property existence constraint due to existing relationship</a></span></li></ul></li></ul></div>

<div class="abstract">
<p>Neo4j helps enforce data integrity with the use of constraints.
Constraints can be applied to either nodes or relationships.
Unique node property constraints can be created, as well as node and relationship property existence constraints.</p>
</div>
<p>You can use unique property constraints to ensure that property values are unique for all nodes with a specific label.
Unique constraints do not mean that all nodes have to have a unique value for the properties — nodes without the property are not subject to this rule.</p>
<p>You can use property existence constraints to ensure that a property exists for all nodes with a specific label or for all relationships with a specific type.
All queries that try to create new nodes or relationships without the property, or queries that try to remove the mandatory property will now fail.</p>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>Property existence constraints are only available in the Neo4j Enterprise Edition.
Note that databases with property existence constraints cannot be opened using Neo4j Community Edition.</p></td></tr></table></div>
<p>You can have multiple constraints for a given label and you can also combine unique and property existence constraints on the same property.</p>
<p>Remember that adding constraints is an atomic operation that can take a while — all existing data has to be scanned before Neo4j can turn the constraint “on”.</p>
<p>Note that adding a unique property constraint on a property will also add an index on that property, so you cannot add such an index separately.
Cypher will use that index for lookups just like other indexes.
If you drop a unique property constraint and still want an index on the property, you will have to create the index.</p>
<p>The existing constraints can be listed using the REST API, see <a class="xref" href="rest-api-schema-constraints.html" title="21.16. Constraints">Section 21.16, “Constraints”</a>.</p>
<section class="section" id="query-constraints-unique-nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Unique node property constraints</h3></div></div></div>

<section class="section" id="constraints-create-uniqueness-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create uniqueness constraint</h4></div></div></div>

<p>To create a constraint that makes sure that your database will never contain more than one node with a specific label and one property value, use the <code class="literal">IS UNIQUE</code> syntax.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</pre><p>
</p>
<div class="queryresult table" id="d5e13920"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Unique constraints added: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-drop-uniqueness-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Drop uniqueness constraint</h4></div></div></div>

<p>By using <code class="literal">DROP CONSTRAINT</code>, you remove a constraint from the database.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">DROP CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</pre><p>
</p>
<div class="queryresult table" id="d5e13940"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Unique constraints removed: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-node-that-complies-with-unique-property-constraints"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a node that complies with unique property constraints</h4></div></div></div>

<p>Create a <code class="literal">Book</code> node with an <code class="literal">isbn</code> that isn’t already in the database.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (book:Book { isbn: '1449356265', title: 'Graph Databases' })</pre><p>
</p>
<div class="queryresult table" id="d5e13961"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Nodes created: 1
</th></tr><tr><th>Properties set: 2
</th></tr><tr><th>Labels added: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-node-that-breaks-a-unique-property-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a node that breaks a unique property constraint</h4></div></div></div>

<p>Create a <code class="literal">Book</code> node with an <code class="literal">isbn</code> that is already used in the database.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (book:Book { isbn: '1449356265', title: 'Graph Databases' })</pre><p>
</p>
<p>In this case the node isn’t created in the graph.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Node 0 already exists with label Book and property "isbn"=[1449356265]</pre><p>
</p>
</section>
<section class="section" id="constraints-failure-to-create-a-unique-property-constraint-due-to-conflicting-nodes"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Failure to create a unique property constraint due to conflicting nodes</h4></div></div></div>

<p>Create a unique property constraint on the property <code class="literal">isbn</code> on nodes with the <code class="literal">Book</code> label when there are two nodes with the same <code class="literal">isbn</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</pre><p>
</p>
<p>In this case the constraint can’t be created because it is violated by existing data. We may choose to use <a class="xref" href="query-schema-index.html" title="14.1. Indexes">Section 14.1, “Indexes”</a> instead or remove the offending nodes and then re-apply the constraint.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Unable to create CONSTRAINT ON ( book:Book ) ASSERT book.isbn IS UNIQUE:
Multiple nodes with label `Book` have property `isbn` = '1449356265':
  node(0)
  node(1)</pre><p>
</p>
</section>
</section>
<section class="section" id="query-constraints-prop-exist-nodes"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Node property existence constraints</h3></div></div></div>

<section class="section" id="constraints-create-node-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create node property existence constraint</h4></div></div></div>

<p>To create a constraint that makes sure that all nodes with a certain label have a certain property, use the <code class="literal">ASSERT exists(identifier.propertyName)</code> syntax.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</pre><p>
</p>
<div class="queryresult table" id="d5e14017"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Property existence constraints added: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-drop-node-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Drop node property existence constraint</h4></div></div></div>

<p>By using <code class="literal">DROP</code> <code class="literal">CONSTRAINT</code>, you remove a constraint from the database.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">DROP CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</pre><p>
</p>
<div class="queryresult table" id="d5e14038"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Property existence constraints removed: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-node-that-complies-with-property-existence-constraints"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a node that complies with property existence constraints</h4></div></div></div>

<p>Create a <code class="literal">Book</code> node with an existing <code class="literal">isbn</code> property.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (book:Book { isbn: '1449356265', title: 'Graph Databases' })</pre><p>
</p>
<div class="queryresult table" id="d5e14059"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Nodes created: 1
</th></tr><tr><th>Properties set: 2
</th></tr><tr><th>Labels added: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-node-that-breaks-a-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a node that breaks a property existence constraint</h4></div></div></div>

<p>Trying to create a <code class="literal">Book</code> node without an <code class="literal">isbn</code> property, given a property existence constraint on <code class="literal">:Book(isbn)</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (book:Book { title: 'Graph Databases' })</pre><p>
</p>
<p>In this case the node isn’t created in the graph.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Node 1 with label "Book" must have the property "isbn" due to a constraint</pre><p>
</p>
</section>
<section class="section" id="constraints-removing-an-existence-constrained-node-property"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Removing an existence constrained node property</h4></div></div></div>

<p>Trying to remove the <code class="literal">isbn</code> property from an existing node <code class="literal">book</code>, given a property existence constraint on <code class="literal">:Book(isbn)</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">MATCH (book:Book { title: 'Graph Databases' })
REMOVE book.isbn</pre><p>
</p>
<p>In this case the property is not removed.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Node 0 with label "Book" must have the property "isbn" due to a constraint</pre><p>
</p>
</section>
<section class="section" id="constraints-failure-to-create-a-node-property-existence-constraint-due-to-existing-node"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Failure to create a node property existence constraint due to existing node</h4></div></div></div>

<p>Create a constraint on the property <code class="literal">isbn</code> on nodes with the <code class="literal">Book</code> label when there already exists  a node without an <code class="literal">isbn</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</pre><p>
</p>
<p>In this case the constraint can’t be created because it is violated by existing data. We may choose to remove the offending nodes and then re-apply the constraint.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Unable to create CONSTRAINT ON ( book:Book ) ASSERT exists(book.isbn):
Node(0) with label `Book` has no value for property `isbn`</pre><p>
</p>
</section>
</section>
<section class="section" id="query-constraints-prop-exist-rels"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Relationship property existence constraints</h3></div></div></div>

<section class="section" id="constraints-create-relationship-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create relationship property existence constraint</h4></div></div></div>

<p>To create a constraint that makes sure that all relationships with a certain type have a certain property, use the <code class="literal">ASSERT exists(identifier.propertyName)</code> syntax.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</pre><p>
</p>
<div class="queryresult table" id="d5e14130"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Property existence constraints added: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-drop-relationship-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Drop relationship property existence constraint</h4></div></div></div>

<p>To remove a constraint from the database, use <code class="literal">DROP CONSTRAINT</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">DROP CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</pre><p>
</p>
<div class="queryresult table" id="d5e14150"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Property existence constraints removed: 1</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-relationship-that-complies-with-property-existence-constraints"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a relationship that complies with property existence constraints</h4></div></div></div>

<p>Create a <code class="literal">LIKED</code> relationship with an existing <code class="literal">day</code> property.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (user:User)-[like:LIKED { day: 'yesterday' }]-&gt;(book:Book)</pre><p>
</p>
<div class="queryresult table" id="d5e14171"><p class="title"><strong>Result</strong></p><div class="queryresult table-contents"><table cellspacing="0" cellpadding="0"><tfoot><tr><th>Nodes created: 2
</th></tr><tr><th>Relationships created: 1
</th></tr><tr><th>Properties set: 1
</th></tr><tr><th>Labels added: 2</th></tr></tfoot><tbody><tr><td class="emptyresult"><p><code class="literal">(empty result)</code></p></td></tr></tbody></table></div></div>
</section>
<section class="section" id="constraints-create-a-relationship-that-breaks-a-property-existence-constraint"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Create a relationship that breaks a property existence constraint</h4></div></div></div>

<p>Trying to create a <code class="literal">LIKED</code> relationship without a <code class="literal">day</code> property, given a property existence constraint <code class="literal">:LIKED(day)</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE (user:User)-[like:LIKED]-&gt;(book:Book)</pre><p>
</p>
<p>In this case the relationship isn’t created in the graph.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Relationship 1 with type "LIKED" must have the property "day" due to a constraint</pre><p>
</p>
</section>
<section class="section" id="constraints-removing-an-existence-constrained-relationship-property"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Removing an existence constrained relationship property</h4></div></div></div>

<p>Trying to remove the <code class="literal">day</code> property from an existing relationship <code class="literal">like</code> of type <code class="literal">LIKED</code>, given a property existence constraint <code class="literal">:LIKED(day)</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">MATCH (user:User)-[like:LIKED]-&gt;(book:Book)
REMOVE like.day</pre><p>
</p>
<p>In this case the property is not removed.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Relationship 0 with type "LIKED" must have the property "day" due to a constraint</pre><p>
</p>
</section>
<section class="section" id="constraints-failure-to-create-a-relationship-property-existence-constraint-due-to-existing-relationship"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title">Failure to create a relationship property existence constraint due to existing relationship</h4></div></div></div>

<p>Create a constraint on the property <code class="literal">day</code> on relationships with the <code class="literal">LIKED</code> type when there already exists a relationship without a property named <code class="literal">day</code>.</p>
<p><strong>Query </strong>
</p><pre class="programlisting" data-lang="cypher">CREATE CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</pre><p>
</p>
<p>In this case the constraint can’t be created because it is violated by existing data. We may choose to remove the offending relationships and then re-apply the constraint.</p>
<p><strong>Error message </strong>
</p><pre class="programlisting" data-lang="plain">Unable to create CONSTRAINT ON ()-[ liked:LIKED ]-() ASSERT exists(liked.day):
Relationship(0) with type `LIKED` has no value for property `day`</pre><p>
</p>
</section>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>