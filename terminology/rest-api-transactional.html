<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>21.1. Transactional Cypher HTTP endpoint -  - The Neo4j Manual v2.2-SNAPSHOT</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="rest-api.html" title="Chapter 21. REST API" /><link rel="next" href="status-codes.html" title="21.2. Neo4j Status Codes" /><link rel="copyright" href="ln-d5e39.html" title="License: Creative Commons 3.0" /><meta name="Section-title" content="21.1. Transactional Cypher HTTP endpoint" /><script type="text/javascript">
      //The id for tree cookie
      var treeCookieId = "treeview-72623";
      var language = "en";
      var w = new Object();
      //Localization
      txt_filesfound = 'Results';
      txt_enter_at_least_1_char = "You must enter at least one character.";
      txt_browser_not_supported = "JavaScript is disabled on your browser. Please enable JavaScript to enjoy all the features of this site.";
      txt_please_wait = "Please wait. Search in progress...";
      txt_results_for = "Results for: ";
    </script><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" /><link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/redmond/jquery-ui.min.css" /><link rel="stylesheet" type="text/css" href="common/jquery/treeview/jquery.treeview.css" /><link rel="stylesheet" type="text/css" href="common/css/positioning.css" /><link rel="stylesheet" type="text/css" href="common/css/style.css" /><!--[if IE]>
  <link rel="stylesheet" type="text/css" href="../common/css/ie.css"/>
  <![endif]--><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" /><script type="text/javascript" src="common/browserDetect.js"></script><script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script><script type="text/javascript" src="common/jquery/jquery.highlight.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script type="text/javascript" src="common/jquery/treeview/jquery.treeview.min.js"></script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/1.4.11/jquery.scrollTo.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script><script type="text/javascript" src="common/main.js"></script><script type="text/javascript" src="search/l10n.js"></script><script type="text/javascript" src="search/htmlFileInfoList.js"></script><script type="text/javascript" src="common/search.js"></script><script type="text/javascript" src="search/stemmers/en_stemmer.js"></script><script type="text/javascript" src="search/index-1.js"></script><script type="text/javascript" src="search/index-2.js"></script><script type="text/javascript" src="search/index-3.js"></script>


<!-- favicon -->

<link rel="shortcut icon" href="common/images/favicon.ico" />

<!-- fonts -->

<link href='//fonts.googleapis.com/css?family=Ubuntu+Mono|PT+Sans:400,700,400italic' rel='stylesheet' type='text/css' />

<!-- Syntax Highlighter -->

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/theme/neo.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/codemirror.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/addon/runmode/runmode.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/javascript/javascript.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/shell/shell.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/sql/sql.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/xml/xml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/clike/clike.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/cypher/cypher.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/4.6.0/mode/properties/properties.min.js"></script>

<script src="js/colorize.js"></script>
 
<script type="text/javascript">
  $(function (){
    CodeMirror.colorize();
  });
</script>

<!-- Cypher Console -->

<script type="text/javascript" src="js/console.js"></script>
<script type="text/javascript" src="js/cypherconsole.js"></script>

<!-- Version -->
<script type="text/javascript" src="js/version.js"></script>
<script type="text/javascript" src="js/versionswitcher.js"></script>

<!-- Discuss -->
<script type="text/javascript" src="js/mutate.min.js"></script>
<script type="text/javascript" src="js/disqus.js"></script>

<script type="text/javascript">
    /*@cc_on @*/
    /*@
     $( '#content' ).addClass( 'internet-explorer' );
     @*/
</script>


</head><body><div id="header"><a href="index.html" id="logo"><img src="common/images/logo-neo4j.svg" alt="" /></a><h1><span id="book-title">The Neo4j Manual v2.2-SNAPSHOT</span><span>21.1. Transactional Cypher HTTP endpoint</span></h1><div id="navheader"><!----><div id="navLinks"><span><a id="showHideButton" href="#" class="pointLeft" tabindex="5" title="Show/Hide TOC tree"><i class="fa fa-columns"></i> Contents
            </a></span><span><a accesskey="p" id="navLinkPrevious" tabindex="5" href="rest-api.html"><i class="fa fa-arrow-circle-left"></i> Prev</a></span><span><a accesskey="u" id="navLinkUp" tabindex="5" href="rest-api.html">Up <i class="fa fa-arrow-circle-up"></i></a></span><span><a accesskey="n" id="navLinkNext" tabindex="5" href="status-codes.html">Next <i class="fa fa-arrow-circle-right"></i></a></span></div></div></div><div id="content"><section class="section" id="rest-api-transactional"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both">21.1. Transactional Cypher HTTP endpoint</h2></div></div></div><div class="toc"><ul class="toc"><li><span class="section"><a href="rest-api-transactional.html#rest-api-begin-and-commit-a-transaction-in-one-request">Begin and commit a transaction in one request</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-begin-a-transaction">Begin a transaction</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-execute-statements-in-an-open-transaction">Execute statements in an open transaction</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-execute-statements-in-an-open-transaction-in-rest-format-for-the-return">Execute statements in an open transaction in REST format for the return</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-reset-transaction-timeout-of-an-open-transaction">Reset transaction timeout of an open transaction</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-commit-an-open-transaction">Commit an open transaction</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-rollback-an-open-transaction">Rollback an open transaction</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-return-results-in-graph-format">Return results in graph format</a></span></li><li><span class="section"><a href="rest-api-transactional.html#rest-api-handling-errors">Handling errors</a></span></li></ul></div>

<p>The Neo4j transactional HTTP endpoint allows you to execute a series of Cypher statements within the scope of a transaction.
The transaction may be kept open across multiple HTTP requests, until the client chooses to commit or roll back.
Each HTTP request can include a list of statements, and for convenience you can include statements along with a request to begin or commit a transaction.</p>
<p>The server guards against orphaned transactions by using a timeout.
If there are no requests for a given transaction within the timeout period, the server will roll it back.
You can configure the timeout in the server configuration, by setting <span class="emphasis"><em>org.neo4j.server.transaction.timeout</em></span> to the number of seconds before timeout.
The default timeout is 60 seconds.</p>
<p>The key difference between the transactional HTTP endpoint for Cypher and the Cypher endpoint (see <a class="xref" href="rest-api-cypher.html" title="21.6. Legacy Cypher HTTP endpoint">Section 21.6, “Legacy Cypher HTTP endpoint”</a>) is the ability to use the same transaction across multiple HTTP requests.
The Cypher endpoint always attempts to commit a transaction at the end of each HTTP request.
Theere has also been improvements to the serialization format.</p>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>The serialization format for Cypher results is mostly the same as the <a class="link" href="rest-api-cypher.html" title="21.6. Legacy Cypher HTTP endpoint">Cypher endpoint</a>.
However, the format for raw entities is slightly less verbose and does not include hypermedia links.</p></td></tr></table></div>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>Open transactions are not shared among members of an HA cluster.
Therefore, if you use this endpoint in an HA cluster, you must ensure that all requests for a given transaction are sent to the same Neo4j instance.</p></td></tr></table></div>
<div class="admonitionblock Note"><table><tr><td class="icon"><img alt="[Note]" src="images/icons/admon/note.svg" /></td><td class="content"><b>Note</b><p>Cypher queries with <code class="literal">USING PERIODIC COMMIT</code>  (see <a class="xref" href="query-periodic-commit.html" title="11.9. Using Periodic Commit">Section 11.9, “Using Periodic Commit”</a>) may only be executed when creating a new transaction and immediately committing it with a single HTTP request (see <a class="xref" href="rest-api-transactional.html#rest-api-begin-and-commit-a-transaction-in-one-request" title="Begin and commit a transaction in one request">the section called “Begin and commit a transaction in one request”</a> for how to do that).</p></td></tr></table></div>
<div class="admonitionblock Tip"><table><tr><td class="icon"><img alt="[Tip]" src="images/icons/admon/tip.svg" /></td><td class="content"><b>Tip</b><p>In order to speed up queries in repeated scenarios, try not to use literals but replace them with parameters wherever possible.
This will let the server cache query plans.
See <a class="xref" href="cypher-parameters.html" title="7.5. Parameters">Section 7.5, “Parameters”</a> for more information.</p></td></tr></table></div>
<section class="section" id="rest-api-begin-and-commit-a-transaction-in-one-request"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Begin and commit a transaction in one request</h3></div></div></div>

<p>If there is no need to keep a transaction open across multiple HTTP requests, you can begin a transaction,
execute statements, and commit with just a single HTTP request.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/commit</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN id(n)"
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "results" : [ {
    "columns" : [ "id(n)" ],
    "data" : [ {
      "row" : [ 3 ]
    } ]
  } ],
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-begin-a-transaction"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Begin a transaction</h3></div></div></div>

<p>You begin a new transaction by posting zero or more Cypher statements
to the transaction endpoint. The server will respond with the result of
your statements, as well as the location of your open transaction.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE (n {props}) RETURN n",
    "parameters" : {
      "props" : {
        "name" : "My Node"
      }
    }
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">201:</code></strong></span> <code class="literal">Created</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Location:</code></strong></span> <code class="literal">http://localhost:7474/db/data/transaction/7</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "commit" : "http://localhost:7474/db/data/transaction/7/commit",
  "results" : [ {
    "columns" : [ "n" ],
    "data" : [ {
      "row" : [ {
        "name" : "My Node"
      } ]
    } ]
  } ],
  "transaction" : {
    "expires" : "Mon, 01 Dec 2014 08:36:56 +0000"
  },
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-execute-statements-in-an-open-transaction"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Execute statements in an open transaction</h3></div></div></div>

<p>Given that you have an open transaction, you can make a number of requests, each of which executes additional
statements, and keeps the transaction open by resetting the transaction timeout.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/9</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN n"
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "commit" : "http://localhost:7474/db/data/transaction/9/commit",
  "results" : [ {
    "columns" : [ "n" ],
    "data" : [ {
      "row" : [ { } ]
    } ]
  } ],
  "transaction" : {
    "expires" : "Mon, 01 Dec 2014 08:36:56 +0000"
  },
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-execute-statements-in-an-open-transaction-in-rest-format-for-the-return"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Execute statements in an open transaction in REST format for the return</h3></div></div></div>

<p>Given that you have an open transaction, you can make a number of requests, each of which executes additional
statements, and keeps the transaction open by resetting the transaction timeout. Specifying the <code class="literal">REST</code> format will
give back full Neo4j Rest API representations of the Neo4j Nodes, Relationships and Paths, if returned.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/1</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN n",
    "resultDataContents" : [ "REST" ]
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "commit" : "http://localhost:7474/db/data/transaction/1/commit",
  "results" : [ {
    "columns" : [ "n" ],
    "data" : [ {
      "rest" : [ {
        "outgoing_relationships" : "http://localhost:7474/db/data/node/0/relationships/out",
        "labels" : "http://localhost:7474/db/data/node/0/labels",
        "traverse" : "http://localhost:7474/db/data/node/0/traverse/{returnType}",
        "all_typed_relationships" : "http://localhost:7474/db/data/node/0/relationships/all/{-list|&amp;|types}",
        "self" : "http://localhost:7474/db/data/node/0",
        "property" : "http://localhost:7474/db/data/node/0/properties/{key}",
        "properties" : "http://localhost:7474/db/data/node/0/properties",
        "outgoing_typed_relationships" : "http://localhost:7474/db/data/node/0/relationships/out/{-list|&amp;|types}",
        "incoming_relationships" : "http://localhost:7474/db/data/node/0/relationships/in",
        "create_relationship" : "http://localhost:7474/db/data/node/0/relationships",
        "paged_traverse" : "http://localhost:7474/db/data/node/0/paged/traverse/{returnType}{?pageSize,leaseTime}",
        "all_relationships" : "http://localhost:7474/db/data/node/0/relationships/all",
        "incoming_typed_relationships" : "http://localhost:7474/db/data/node/0/relationships/in/{-list|&amp;|types}",
        "metadata" : {
          "id" : 0,
          "labels" : [ ]
        },
        "data" : { }
      } ]
    } ]
  } ],
  "transaction" : {
    "expires" : "Mon, 01 Dec 2014 08:36:52 +0000"
  },
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-reset-transaction-timeout-of-an-open-transaction"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Reset transaction timeout of an open transaction</h3></div></div></div>

<p>Every orphaned transaction is automatically expired after a period of inactivity.  This may be prevented
by resetting the transaction timeout.</p>
<p>The timeout may be reset by sending a keep-alive request to the server that executes an empty list of statements.
This request will reset the transaction timeout and return the new time at which the transaction will
expire as an RFC1123 formatted timestamp value in the “transaction” section of the response.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/2</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "commit" : "http://localhost:7474/db/data/transaction/2/commit",
  "results" : [ ],
  "transaction" : {
    "expires" : "Mon, 01 Dec 2014 08:36:55 +0000"
  },
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-commit-an-open-transaction"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Commit an open transaction</h3></div></div></div>

<p>Given you have an open transaction, you can send a commit request. Optionally, you submit additional statements
along with the request that will be executed before committing the transaction.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/4/commit</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN id(n)"
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "results" : [ {
    "columns" : [ "id(n)" ],
    "data" : [ {
      "row" : [ 2 ]
    } ]
  } ],
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-rollback-an-open-transaction"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Rollback an open transaction</h3></div></div></div>

<p>Given that you have an open transaction, you can send a rollback request. The server will rollback the
transaction. Any further statements trying to run in this transaction will fail immediately.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">DELETE</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/3</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "results" : [ ],
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-return-results-in-graph-format"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Return results in graph format</h3></div></div></div>

<p>If you want to understand the graph structure of nodes and relationships returned by your query,
you can specify the "graph" results data format. For example, this is useful when you want to visualise the
graph structure. The format collates all the nodes and relationships from all columns of the result,
and also flattens collections of nodes and relationships, including paths.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/commit</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "CREATE ( bike:Bike { weight: 10 } ) CREATE ( frontWheel:Wheel { spokes: 3 } ) CREATE ( backWheel:Wheel { spokes: 32 } ) CREATE p1 = (bike)-[:HAS { position: 1 } ]-&gt;(frontWheel) CREATE p2 = (bike)-[:HAS { position: 2 } ]-&gt;(backWheel) RETURN bike, p1, p2",
    "resultDataContents" : [ "row", "graph" ]
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "results" : [ {
    "columns" : [ "bike", "p1", "p2" ],
    "data" : [ {
      "row" : [ {
        "weight" : 10
      }, [ {
        "weight" : 10
      }, {
        "position" : 1
      }, {
        "spokes" : 3
      } ], [ {
        "weight" : 10
      }, {
        "position" : 2
      }, {
        "spokes" : 32
      } ] ],
      "graph" : {
        "nodes" : [ {
          "id" : "4",
          "labels" : [ "Bike" ],
          "properties" : {
            "weight" : 10
          }
        }, {
          "id" : "5",
          "labels" : [ "Wheel" ],
          "properties" : {
            "spokes" : 3
          }
        }, {
          "id" : "6",
          "labels" : [ "Wheel" ],
          "properties" : {
            "spokes" : 32
          }
        } ],
        "relationships" : [ {
          "id" : "0",
          "type" : "HAS",
          "startNode" : "4",
          "endNode" : "5",
          "properties" : {
            "position" : 1
          }
        }, {
          "id" : "1",
          "type" : "HAS",
          "startNode" : "4",
          "endNode" : "6",
          "properties" : {
            "position" : 2
          }
        } ]
      }
    } ]
  } ],
  "errors" : [ ]
}</pre>
</section>
<section class="section" id="rest-api-handling-errors"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title">Handling errors</h3></div></div></div>

<p>The result of any request against the transaction endpoint is streamed back to the client.
Therefore the server does not know whether the request will be successful or not when it sends the HTTP status
code.</p>
<p>Because of this, all requests against the transactional endpoint will return 200 or 201 status code, regardless
of whether statements were successfully executed. At the end of the response payload, the server includes a list
of errors that occurred while executing statements. If this list is empty, the request completed successfully.</p>
<p>If any errors occur while executing statements, the server will roll back the transaction.</p>
<p>In this example, we send the server an invalid statement to demonstrate error handling.</p>
<p>For more information on the status codes, see <a class="xref" href="status-codes.html" title="21.2. Neo4j Status Codes">Section 21.2, “Neo4j Status Codes”</a>.</p>
<p><span class="emphasis"><em>Example request</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">POST</code></strong></span>  <code class="literal">http://localhost:7474/db/data/transaction/8/commit</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Accept:</code></strong></span> <code class="literal">application/json; charset=UTF-8</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "statements" : [ {
    "statement" : "This is not a valid Cypher Statement."
  } ]
}</pre>
<p><span class="emphasis"><em>Example response</em></span></p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">

<span class="strong"><strong><code class="literal">200:</code></strong></span> <code class="literal">OK</code>

</li><li class="listitem">

<span class="strong"><strong><code class="literal">Content-Type:</code></strong></span> <code class="literal">application/json</code>

</li></ul></div>
<pre class="programlisting" data-lang="javascript">{
  "results" : [ ],
  "errors" : [ {
    "code" : "Neo.ClientError.Statement.InvalidSyntax",
    "message" : "Invalid input 'T': expected &lt;init&gt; (line 1, column 1)\n\"This is not a valid Cypher Statement.\"\n ^"
  } ]
}</pre>
</section>
</section>

 <footer>
   <p>
   © Copyright
   <a href="http://creativecommons.org/licenses/by-sa/3.0/"><img id="copyright-img" src="images/by-sa.svg" alt="CC BY-SA 3.0" title="Creative Commons Attribution-ShareAlike 3.0"></a>
   <a href="http://neo4j.com/"><img id="neotech-logo" src="images/neo-technology.svg" alt="Neo Technology"></a>
   </p>
 </footer>
  <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    //Allow Linker
    ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
    ga('send', 'pageview');

    // Load the plugin.
    ga('require', 'linker');

    // Define which domains to autoLink.
    ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
  </script>

</div></body></html>